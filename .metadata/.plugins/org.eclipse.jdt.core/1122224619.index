    #attainableCouponDiv {\n            display: flex;\n            flex-direction: row;\n            justify-content: center;\n            background: linear-gradient(90deg, rgba(255, 249, 217, 0.6) 0%, rgba(233, 251, 255, 0.6) 53.12%, rgba(221, 235, 255, 0.6) 100%);\n            width: calc(100% + 40px);\n            height: 52px;\n            margin-left: -20px;\n            margin-right: -20px;\n        }\n        #attLock {\n            width: 20px;\n            height: 20px;\n            margin-right: 12px;\n            align-self: center;\n        }\n        #attPrompt {\n            font-size: 12px;\n            line-height: 20px;\n            margin: 0px;\n            align-self: center;\n        }\n        #notificationDiv {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            background: linear-gradient(90deg, rgba(255, 249, 217, 0.6) 0%, rgba(233, 251, 255, 0.6) 53.12%, rgba(221, 235, 255, 0.6) 100%);\n            width: calc(100%);\n            margin-top: -20px;\n        }\n        #notificationBanner {\n            display: flex;\n            flex-direction: row;\n            justify-content: center;\n            width: calc(100%);\n            height: 52px;\n        }\n        "}getDarkModeStyles(){return"\n        #attainableCouponDiv, #notificationDiv {\n            background: linear-gradient(90deg, rgba(105, 99, 67, 0.6) 0%, rgba(83, 101, 105, 0.6) 53.12%, rgba(71, 85, 105, 0.6) 100%);\n        }\n        "}};var Sq=class{constructor(t,e,n,o){i(this,"cartValue",void 0),i(this,"lastAttainableCoupon",void 0),i(this,"attainableCouponList",[]),i(this,"utilities",void 0),i(this,"flyoutData",void 0),i(this,"assets",void 0),i(this,"pageHandlerModule",void 0),i(this,"storageHandler",void 0),i(this,"tooltipUtilities",void 0),i(this,"logModule",void 0),i(this,"lockedCoupons",void 0),i(this,"data",void 0),this.utilities=t.viewModulesUtilities,this.flyoutData=e,this.assets=new vq,this.pageHandlerModule=n,this.storageHandler=t.storageHandler,this.tooltipUtilities=t.tooltipUtilities,this.logModule=o,this.cartValue=-1,this.lockedCoupons=[]}async setupAttainableCoupons(){const t=this.flyoutData.common.domain;ae(t,"lastAttainableCoupon"),ae(t,"attainableCouponMap");const e=await this.storageHandler.getStorageString("CartValues");if(!n(e))try{const i=JSON.parse(e),n=new Date,o=i?i[t]:void 0,r=o?new Date(o.timestamp):null,a=r?n.getTime()-r.getTime():0;if(Math.floor(a/1e3/60/60/24)>0)this.storageHandler.clearDomainMappedStringStorage("CartValues",t,i);else{const t=o?.cartValue;this.cartValue=t?.OrderTotal??-1}}catch(t){}const i=ne("lastAttainableCoupon"),o=i[t]??{};this.lastAttainableCoupon=o.referenceCoupon;const r=ne("attainableCouponMap"),a=r[t]??{};this.attainableCouponList=a.attainableCouponList??[];if(await this.storageHandler.getStorageBool("CompletedPurchase"))try{i[t]={},r[t]={},this.storageHandler.setStorageBool("CompletedPurchase",!1),re("lastAttainableCoupon",JSON.stringify(i)),re("attainableCouponMap",JSON.stringify(r))}catch(t){}}async shouldCreateBanner(t){this.updateLockedCoupons(this.cartValue),this.data=await this.parseInfo(this.flyoutData.common.domain);const e=this.data?.isCouponAttained&&this.data?.lastAttainableCoupon&&!this.data?.referenceCoupon,i=this.data?.referenceCoupon&&this.lockedCoupons.length>0,n=t&&(e||i);return n||re("attainableCouponDisplayed","false"),n}createBanner(t){this.utilities.applyStyles(this.flyoutData.common.shopping,this.assets.getStyles(),void 0,this.assets.getDarkModeStyles());const e=pi("div");e.slot="start-content",e.id="attainableCouponDiv",e.setAttribute("role","group"),e.setAttribute("aria-labelledby","attPrompt");const i=this.flyoutData.common.domain;if(this.data&&this.data.isCouponAttained&&this.data.lastAttainableCoupon&&!this.data.referenceCoupon)this.populateCouponAttained(this.data.lastSavings,e),this.recordViewed(!0,this.data.lastAttainableCoupon.couponCode);else{if(!(this.data&&this.data.referenceCoupon&&this.lockedCoupons.length>0))return re("attainableCouponDisplayed","false"),null;this.populateAttainableCoupon(this.data.referenceCoupon,this.data.referenceSavings,this.data.lastAttainableCoupons,i,e),this.createInfoTooltip(e,this.data.referenceCoupon,this.data.referenceSavings),this.recordViewed(!1,this.data.referenceCoupon.couponCode)}re("attainableCouponDisplayed","true");c.isExperimentActive(a.incentiveCampaign)&&void 0!==this.flyoutData.dataStoreModule.IncentiveCampaignData&&!this.flyoutData.dataStoreModule.IncentiveCampaignData.isRewardClaimed||t.prepend(e)}recordViewed(t,e){const i=new u(C.ModuleViewed,void 0,void 0,void 0,e),n=t?an.COUPON_ATTAINED:an.ATTAINABLE_COUPONS;this.pageHandlerModule.RecordAsContentViewed(n),this.logModule.LogInfoEvent(p.EdgeFlyoutStatus,`${n}`,i)}populateCouponAttained(t,e){const i=pi("p");i.id="attPrompt";const n=this.flyoutData.strings.attFlyoutUnlocked,o=Me.GetMarket(this.flyoutData.dataStoreModule.ApiData?.market,this.flyoutData.dataStoreModule.ApiData?.retailerData?.exclusiveMarket),r=yq.GetSavingsString(t,o),a=pi("span",{style:"display: inline; color: var(--neutral-foreground-rest); font-size: 14px; font-weight: bold;"});a.textContent=r,Me.ReplaceElementInKey(i,n,a),e.append(i)}populateAttainableCoupon(t,e,i,n,o){if(void 0===t||void 0===e)return Promise.resolve(null);{const e=new Date;i[n]={referenceCoupon:t,timestamp:e};re("lastAttainableCoupon",JSON.stringify(i))}const r=pi("p");r.id="attPrompt";const a=t?.minimumPurchase??t?.calculatedCutoffPrice??0,s=this.flyoutData.strings.attFlyoutLocked,l=pi("span",{style:"display: inline; color: var(--neutral-foreground-rest); font-size: 12px; font-weight: bold;"});l.textContent=`${q.currency}${a.toFixed(2)}`,l.textContent=Me.ReplaceStringsPlaceholders(l.textContent);const c=Me.GetMarket(this.flyoutData.dataStoreModule.ApiData?.market,this.flyoutData.dataStoreModule.ApiData?.retailerData?.exclusiveMarket),d=yq.GetSavingsString(e,c),u=pi("span",{style:"display: inline; color: var(--neutral-foreground-rest); font-size: 12px; font-weight: bold;"});u.textContent=d,Me.ReplaceElementInKey(r,s,l,u),o.append(r)}createInfoTooltip(t,e,i){const n=Me.GetMarket(this.flyoutData.dataStoreModule.ApiData?.market,this.flyoutData.dataStoreModule.ApiData?.retailerData?.exclusiveMarket),o=yq.GetSavingsString(i,n)??"savings",r=e?.minimumPurchase??e?.calculatedCutoffPrice??0,a=`${q.currency}${r.toFixed(2)}`,s=`${q.currency}${r.toFixed(2)}`,l=Me.ReplaceValueInKey("attTooltipText",this.flyoutData.strings.attTooltipText,s),c=Me.ReplaceValueInKey("attTooltipHeader",this.flyoutData.strings.attTooltipHeader,o,a),d=this.pageHandlerModule,u=this.logModule;function h(){const t=new ci(g.AttainableInfoIcon,this.telemetryUtilities.setContentViewed(this.GetModuleName()));d.RecordAsUserAction(di.ATTAINABLE_COUPON_CLICK),u.LogInfoEvent(p.ButtonClick,"Attainable coupon info viewed",t)}const f=this.tooltipUtilities.createInfoIconTooltip(Me.ReplaceStringsPlaceholders(l),Me.ReplaceStringsPlaceholders(c),void 0,h,h);f.id="header-tooltip",f.style.alignSelf="center",f.style.marginLeft="4px",t.append(f)}async parseInfo(t){await this.storageHandler.getStorageString("CartValues").then((e=>{if(!n(e))try{const i=JSON.parse(e),n=i[t].cartValue;this.cartValue=n.OrderTotal}catch(t){return{}}}));let e,i,o,r=!1;try{const n=ee("lastAttainableCoupon");if(o=n?JSON.parse(n):{},this.cartValue>0&&o){e=(o[t]??{}).referenceCoupon;e&&(r=(e?.minimumPurchase??e?.calculatedCutoffPrice??0)<this.cartValue,i=yq.GetSavingsAmount(e.shortHeader))}}catch(t){return{}}this.updateLockedCoupons(this.cartValue);let a,s,l,c=75;for(const t of this.lockedCoupons){const e=yq.GetSavingsAmount(t.shortHeader),i=t.minimumPurchase??t.calculatedCutoffPrice??0;l=yq.ShouldPromoteAttainableCoupon(e,this.cartValue,i),t.successRate&&t.successRate>c&&l&&(a=t,s=e,c=t.successRate)}return{isCouponAttained:r,lastAttainableCoupon:e,lastAttainableCoupons:o,lastSavings:i,referenceCoupon:a,referenceSavings:s}}addLockIcon(t,e){const i=this.flyoutData.common.domain,n=ne("attainableCouponMap"),o=t?.minimumPurchase??t?.calculatedCutoffPrice??0;if(yq.IsAttainableCoupon(t,this.cartValue)){e.hasIcon=!0;const o=pi("div");o.innerHTML=this.assets.getLockIcon(),o.slot="icon";const r=o.querySelector("path");if(this.utilities.isDarkMode()&&r&&(r.style.fill="#FFFFFF"),e.append(o),!this.attainableCouponList.includes(t.couponCode)){this.attainableCouponList.push(t.couponCode);const e=new Date;n[i]={attainableCouponList:this.attainableCouponList,timestamp:e};re("attainableCouponMap",JSON.stringify(n))}}else if(this.attainableCouponList.includes(t.couponCode)&&o<this.cartValue){e.hasIcon=!0,e.regularColors=!0;const t=pi("div");t.innerHTML=this.assets.getUnlockedIcon(),t.slot="icon";const i=t.querySelector("path");this.utilities.isDarkMode()&&i&&(i.style.fill="#FFFFFF"),e.append(t)}}updateLockedCoupons(t){if(this.flyoutData.dataStoreModule.CouponData?.Coupons)for(const e of this.flyoutData.dataStoreModule.CouponData?.Coupons){const i=e.minimumPurchase??e.calculatedCutoffPrice??0;i&&i>t&&e.shortHeader&&this.lockedCoupons.push(e)}}hasOnlyAttainableCoupons(){const t=this.flyoutData.dataStoreModule.CouponData?.Coupons??[];if(this.lastAttainableCoupon||this.attainableCouponList?.length>0){const e=t.filter((t=>!(yq.IsAttainableCoupon(t,this.cartValue)||this.attainableCouponList?.includes(t.couponCode)||this.lastAttainableCoupon&&this.lastAttainableCoupon.couponCode===t.couponCode)));return e.length<1}return!1}isCouponAttained(){if(this.lastAttainableCoupon){return(this.lastAttainableCoupon?.minimumPurchase??this.lastAttainableCoupon?.calculatedCutoffPrice??0)<this.cartValue}return!1}filterAttainableCouponList(){const t=this.flyoutData.dataStoreModule.CouponData?.Coupons??[];if(t.length<1)return[];const e=t.filter((t=>!t.isPrivateCoupon));e.sort(((t,e)=>(e.successRate??0)-(t.successRate??0))).sort(((t,e)=>(this.filterAsAttainable(e)?1:0)-(this.filterAsAttainable(t)?1:0)));let i=0;const n=t.flatMap((t=>t.isPrivateCoupon?[t]:i<e.length?[e[i++]]:[]));return n}filterAsAttainable(t){const e=t.minimumPurchase??t.calculatedCutoffPrice??0;return yq.IsAttainableCoupon(t,this.cartValue)||this.attainableCouponList.includes(t.couponCode)||this.lastAttainableCoupon&&e<this.cartValue&&this.lastAttainableCoupon.couponCode===t.couponCode}};var bq=class{getStyles(){return"\n        :root {\n            --slide-count: 0;\n            --slide-width: 76px;\n            --track-width: calc(var(--slide-width) * var(--slide-count));\n            --iteration-time: calc(5s * var(--slide-count));\n            --coupon-color: #0F6CBD;\n        }\n        .divSuccessRate {\n            display: flex;\n            flex-direction: row;\n            border-radius: 0px 3px;\n        }\n        .txtSuccessRate {\n            color: #107C10;\n        }\n        #cbTooltip {\n            display: inline-block;\n            vertical-align: top;\n            white-space: initial;\n            margin-left: 1px;\n        }\n        #cbTooltip.couponTooltip {\n            align-self: center;\n            margin: 0;\n        }\n        #cbTooltip.couponTooltip.small div.btnTooltip {\n            width: 12px;\n        }\n        #divCouponWrapper {\n            display: grid;\n            grid-template-columns: 100%;\n            grid-gap: 12px;\n            margin-bottom: 10px;\n            margin-top: 0px;\n        }\n        #pdpMessage {\n            font-weight: 400;\n            margin: 4px 27px;\n            font-size: 12px;\n            text-align: center;\n        }\n        @keyframes scroll {\n            0% {\n                transform: translateX(0);\n            }\n            100% {\n                transform: translateX(calc(var(--track-width) * -1));\n            }\n        }\n        @keyframes reveal {\n            0% {\n                transform: translateY(28px);\n            }\n            20% {\n                transform: translateY(28px);\n            }\n            100% {\n                transform: translateY(0);\n            }\n        }\n        .refresh {\n            animation: reveal 2s cubic-bezier(0.28, 0.86, 0, 1.02) 1;\n            overflow: hidden;\n            margin-right: 5px;\n        }\n        #carousel {\n            margin-top: 6px;\n            overflow: hidden;\n            position: relative;\n            -webkit-mask-image: linear-gradient(to right, rgba(0, 0, 0, 0) 0%, rgb(0, 0, 0) 2.5%, rgb(0, 0, 0) 97.5%, rgba(0, 0, 0, 0) 100%);\n            display: flex;\n            align-items: center;\n            overflow: hidden;\n            width: 280px;\n        }\n        #carousel:has(#track.stationary) {\n            display: flex;\n            justify-content: center;\n        }\n        #track.stationary {\n            animation: none;\n        }\n        #track {\n            animation: scroll var(--iteration-time) linear infinite;\n            animation-play-state: running;\n            list-style-type: none;\n            display: flex;\n            align-items: center;\n            column-gap: 16px;\n            margin: 0px;\n            padding: 0px;\n        }\n        .coupon {\n            display: flex;\n            flex-direction: row;\n            align-items: center;\n            height: 24px;\n            border: 1px dashed var(--coupon-color);\n            box-sizing: border-box;\n            border-radius: 4px;\n            padding: 0px 6px;\n            overflow: hidden;\n            white-space: nowrap;\n        }\n        .coupon p {\n            color: var(--coupon-color);\n            margin: 0;\n            font-weight: 600;\n            font-size: 12px;\n            line-height: 22px;\n        }\n        .couponInDiscover::part(success-rate) {\n           display: none;\n        }\n        @media (forced-colors: active) {\n            .divSuccessRateIcon svg path:first-child {\n                fill: highlight;\n            }\n            .divSuccessRateIcon svg path:last-child {\n                fill: highlighttext;\n            }\n        }\n        "}getEmptyCouponStyles(){return"\n            .emptyCouponSectionTitle::part(control) {\n                margin-top: 6px;\n            }"}getDarkModeStyles(){return"\n        :root {\n            --coupon-color: #63ADE5;\n        }\n        .txtSuccessRate {\n            color: #62C90C;\n        }\n        .divSuccessRateIcon svg path:first-child {\n            fill: #62C90C;\n        }\n        "}getEmptyHeaderStyles(){return"\n            msft-edge-shopping::part(header) {\n                display: none;\n        }\n        "}};var Tq=class{getStyles(){return'\n        .couponBackgroundCJK {\n            padding-top: 18px;\n            padding-bottom: 18px;\n            padding-left: 22px;\n            padding-right: 22px;\n            border-radius: 12px;\n            display: flex;\n            flex-direction: row;\n            justify-content: space-between;\n            align-items: center;\n            background: radial-gradient(circle at 0 center, transparent 0, transparent 10px, #F9E8E7 10px);\n        }\n        .couponBackgroundCJK:hover {\n            cursor: pointer;\n        }\n        .couponAmountCJK {\n            left: 24px;\n            top: 22px;\n            font-style: normal;\n            font-weight: 600;\n            font-size: 24px;\n            display: flex;\n            align-items: center;\n            line-height: 32px;\n            text-align: justify;\n            color: #E8392C;\n        }\n        .couponDecriptionTextContaineCJK {\n            display: flex;\n            flex-direction: column;\n            margin-left: 24px;\n        }\n        .couponSubtitleUpperCJK {\n            /* Available after 2000 yuan */\n            width: auto;\n            font-family: \'Segoe UI\', "Roboto", Helvetica, Verdana, sans-serif;\n            font-style: normal;\n            font-weight: 600;\n            font-size: 16px;\n            line-height: 22px;\n            /* identical to box height, or 138% */\n            color: #E8392C;\n        }\n        .couponSubtitleUpperCJKFlyout {\n            /* Available after 2000 yuan */\n            width: auto;\n            font-family: "Segoe UI", "Roboto", Helvetica, Verdana, sans-serif;\n            font-style: normal;\n            font-weight: 600;\n            font-size: 13px;\n            line-height: 22px;\n            /* identical to box height, or 138% */\n            color: #E8392C;\n        }\n        .couponSubtitleLowerCJK {\n            /* Only 1 day and 10 hours from expiration of the current product */\n            width: auto;\n            /* Ramp/minus-1\n            Font size one smaller than base.\n            */\n            font-family: \'Segoe UI Variable Static Small\', "Roboto", Helvetica, Verdana, sans-serif;\n            font-style: normal;\n            font-weight: 400;\n            font-size: 12px;\n            padding-top: 6px;\n            line-height: 16px;\n            /* or 133% */\n            color: #E8392C;\n        }\n        .amountTextContainerCJK {\n            display: flex;\n            flex-direction: row;\n        }\n        .couponButtonCJK {\n            /* Use */\n            height: 16px;\n            /* Ramp/minus-1\n            Font size one smaller than base.\n            */\n            font-family: \'Segoe UI Variable Static Small\', "Roboto", Helvetica, Verdana, sans-serif;\n            font-style: normal;\n            font-weight: 400;\n            font-size: 12px;\n            line-height: 16px;\n            text-align: center;\n            color: #E8392C;\n            /* Inside auto layout */\n            flex: none;\n            order: 0;\n            flex-grow: 0;\n            border: 1px solid red;\n            border-radius: 15px;\n            padding: 8px;\n        }\n        '}getDarkModeStyles(){return""}getCjkSectionNumberIconPath(t){return`${t}cjk/sectionnumber.svg`}};var Aq=class{constructor(t){i(this,"numCoupons",void 0),i(this,"flyoutData",void 0),i(this,"instantSavingsUptoXOff",""),i(this,"instantSavingsPercentage",-1),this.flyoutData=t}getInstantSavingsUptoXOff(){return this.instantSavingsUptoXOff||this.getInstantSavingsPercentage()>0&&(this.instantSavingsUptoXOff=Me.ReplaceValueInKey("coupons up to x% off",this.flyoutData.strings.couponsUpToXPercentOff,this.instantSavingsPercentage.toString())),this.instantSavingsUptoXOff}getInstantSavingsPercentage(){if(-1!==this.instantSavingsPercentage)return this.instantSavingsPercentage;if(this.flyoutData.dataStoreModule.ApiData?.retailerData.couponsFilteringEnabled){const t=this.flyoutData.dataStoreModule.CouponData?.Coupons.filter((t=>t.discountPercent&&t.successRate&&!t.isLowSuccessRateCoupon));t&&(t.sort(((t,e)=>e.successRate-t.successRate)),t[0]&&(this.instantSavingsPercentage=t[0].discountPercent))}return this.instantSavingsPercentage}shouldRender(){const t=this.flyoutData.dataStoreModule.PriceComparisonData,e=t?.segment?.toLowerCase();if(((e===dt.AUTOS&&t?.CompetingPrices&&t?.CompetingPrices.length>0)??!1)||e===dt.EMPTYAUTOSSEGMENT)return!1;const i=this.flyoutData.dataStoreModule.CouponData?.Coupons;return i?.length&&(this.numCoupons=i.length),!!i?.length}};var Oq=class extends Ft{constructor(t){super(T.GetFileContentFromResourcesMessage),this.filePath=t}};var xq=class{static async getAutoApplyContent(t,e,i){const n=pi("h1");n.slot="header-content",n.className="popup-content";const o=pi("DIV");o.className="coupon-info";const r=pi("IMG");r.src=await i.GetImageSrc("../images/left-percentage-icon.png");const a=pi("SPAN");a.className="coupon-num",a.textContent=e.Coupons.length.toString();const s=pi("IMG");s.src=await i.GetImageSrc("../images/right-percentage-icon.png");const l=pi("DIV");return l.textContent=t,l.className="coupon-text",o.appendChild(r),o.appendChild(a),o.appendChild(s),n.appendChild(o),n.appendChild(l),n}static applyStyles(t,e,i){if(t){const n=pi("STYLE");n.textContent=e,n.type="text/css",n.rel="stylesheet",i&&(n.id=i),t.appendChild(n)}}static async GetPNGIcon(t,e){const i=(await t.SendMessage(new Oq(e))).fileContent,n=document.createElement("img");return n.src="data:image/png;base64,"+i,n}static GetNoHeaderBackgroundStyles(){return"\n            msft-edge-shopping::part(header) {\n                background-color: unset;\n                padding-bottom: 0;\n                margin: 0;\n            }\n        "}};var Eq=class{constructor(t){i(this,"flyoutData",void 0),this.flyoutData=t}createCouponHeader(t,e,i,n){const o=pi("DIV",{style:"width: 100%; display: flex; flex-direction: row; justify-content: flex-start; column-gap: 16px; text-align: left; font-weight: 500; overflow: hidden; min-height: 67px;"});o.classList.add("lateralMargin"),o.slot="header-content",this.createRetailerIcon(o,e);const r=pi("SPAN");r.textContent=t||e,r.className="txtLarge txtSavingsColor",r.style.display="inline-block",r.style.minHeight="35px";const a=pi("H2");if(a.className="txtLarge",a.style.fontWeight="500",1===i){const t=Me.GetICUPluralString(this.flyoutData.strings.ptCouponsTitleStr,M.One);Me.ReplaceElementInKey(a,t,r)}else{const t=Me.GetICUPluralString(this.flyoutData.strings.ptCouponsTitleStr,M.Other,i);Me.ReplaceElementInKey(a,t,r)}o.appendChild(a),n.appendChild(o)}createRetailerIcon(t,e){const i=pi("DIV");i.setAttribute("role","image");const n=Me.ReplaceValueInKey("commonAriaLogo",this.flyoutData.strings.commonAriaLogo,e);i.setAttribute("aria-label",n),i.id="divProfileImgWrapper";const o=pi("IMG",{style:"width: 50px; height: 50px; place-self: center;\n                    border-radius: 8px; position: relative;\n                    margin-bottom: 8px;"});o.src=`${this.flyoutData.common.resourcesEndpoint}retailerBranding/SquareIcons/${e}.png`,o.setAttribute("aria-hidden","true");const r=pi("IMG");r.setAttribute("aria-hidden","true"),r.src=this.flyoutData.common.resourcesEndpoint+"pinterest/icon.png",r.style.position="absolute",r.style.top="46px",r.style.zIndex="2",o.addEventListener("error",(()=>{t.style.gridTemplateColumns="auto",t.style.textAlign="center",t.style.justifyContent="center",t.style.height="auto",o.remove(),r.remove()})),i.appendChild(o),i.appendChild(r),t.appendChild(i)}};var Pq=class{getStyles(){return"\n            .popup-content {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                padding-bottom: 20px;\n                margin: 0;\n            }\n            .coupon-info {\n                padding-bottom: 10px;\n            }\n            .coupon-num {\n                font-size: 36px;\n                font-weight: 500;\n            }\n            .coupon-text {\n                font-size: 24px;\n                font-weight: 500;\n            }\n            .safari-auto-apply-btn {\n                height: 32px;\n                font-size: 14px;\n                font-weight: 600;\n                line-height: 20px;\n                background: #2169EB;\n            }\n            .safari-region {\n                background: white;\n                margin: 20px;\n                margin-top: 0px;\n                padding: 10px;\n                border-radius: 8px;\n            }\n        "}};var Iq=class{getStyles(){return"\n        #socialCouponSection {\n            width: 100%;\n            text-align: left;\n        }\n        #divImgWrapper {\n            border-radius: 50%;\n            overflow: hidden;\n            z-index: 1;\n            place-self: center;\n        }\n        #divProfileImgWrapper {\n            background-color: var(--fill-color);\n            border-radius: 50%;\n            place-self: center;\n            position: relative;\n            display: flex;\n            justify-content: center;\n        }\n        #divInfluencerInfo {\n            width: 100%;\n            display: flex;\n            flex-direction: row;\n            place-self: center;\n            align-items:center;\n            column-gap: 16px;\n            min-height: 70px;\n            box-sizing: border-box;\n            padding-bottom: 0px;\n            padding-top: 0px;\n            z-index: 5;\n        }\n        .divRetailerCoupon {\n            width: 100%;\n            display: grid;\n            grid-template-columns: 40% 60%;\n            place-self: center;\n            align-items:center;\n            margin-bottom: 5px;\n            background: linear-gradient(0deg, #FFFFFF, #FFFFFE);\n            border: 1px solid rgba(234, 230, 232, 0.5);\n            box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.04);\n            border-radius: 8px;\n            column-gap: 12px;\n            min-height: 105px;\n            box-sizing: border-box;\n            padding: 8px;\n        }\n        .divCouponCodeWrapper {\n            display: flex;\n            flex-direction: column;\n            place-self: center;\n            background: #F7F4F5;\n            border-radius: 8px;\n            width: 100%;\n            height: 100%;\n            justify-content: center;\n            align-items: center;\n            row-gap: 8px;\n        }\n        .divRetailerInfluencerWrapper {\n            display: flex;\n            flex-direction: row;\n            justify-content: flex-start;\n            align-items: center;\n            column-gap: 8px;\n            padding: 5px;\n        }\n        "}getDarkModeStyles(){return"\n        .divRetailerInfluencerWrapper .txtSmall {\n            opacity: 1!important;\n        }\n    "}getCouponsStyles(){return".ytCouponElement {\n            display: flex;\n            flex-direction: column;\n            row-gap: 8px;\n            justify-content: center;\n            align-items: center;\n            width: 150px;\n            min-height: 74px;\n            background: linear-gradient(0deg, #FFFFFF, #FFFFFF);\n            border: 1px solid rgba(234, 230, 232, 0.5);\n            box-sizing: border-box;\n            box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.04);\n            border-radius: 8px;\n            cursor: pointer;\n        }\n        .divYTCouponWrapperTemplate {\n            display: grid;\n            grid-gap: 12px;\n            margin-bottom: 12px;\n        }"}},Dq=o(39711);class _q{constructor(t,e){i(this,"authToken",void 0),i(this,"emails",void 0),this.emails=t,this.authToken=e}}class kq{constructor(t,e,n){i(this,"id",void 0),i(this,"emailProvider",void 0),i(this,"active",void 0),this.id=t,this.emailProvider=e,this.active=n}}let wq=function(t){return t.InboxCoupons="InboxCoupons",t.ActiveRetailerInboxCoupons="ActiveRetailerInboxCoupons",t}({}),Nq=(function(t){t[t.InboxCoupons=tt.INBOX_COUPONS]="InboxCoupons",t[t.ActiveRetailerInboxCoupons=tt.ACTIVE_RETAILER_INBOX_COUPONS]="ActiveRetailerInboxCoupons"}({}),function(t){return t.InboxCoupons="inboxCouponSection",t.ActiveRetailerInboxCoupons="activeRetailerInboxCouponsSection",t}({}));const Mq=async function(t){if(!t)return"";const e=(new TextEncoder).encode(t),i=await crypto.subtle.digest("SHA-256",e),n=Array.from(new Uint8Array(i)).map((t=>t.toString(16).padStart(2,"0"))).join("");return n};function Rq(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Lq(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rq(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rq(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}class Bq{constructor(){i(this,"pageHandlerModuleInstance",void 0),i(this,"logModuleInstance",void 0),i(this,"flyoutDataInstance",void 0),i(this,"telemetryUtilitiesInstance",void 0),i(this,"getAuthInfoInstance",void 0),i(this,"getModuleInfoHandlers",{}),i(this,"environment",void 0);try{this.environment="production"}catch{this.environment="unknown"}}static get Instance(){return this.instance||(this.instance=new this)}set pageHandlerModule(t){this.pageHandlerModuleInstance=t}set logModule(t){this.logModuleInstance=t}set telemetryUtilities(t){this.telemetryUtilitiesInstance=t}set flyoutData(t){this.flyoutDataInstance=t}set getAuthInfo(t){this.getAuthInfoInstance=t}addModuleInfoHandler(t,e){this.getModuleInfoHandlers=Lq(Lq({},this.getModuleInfoHandlers),{},{[t]:e})}async sendActionTelemetry(t,e=!0){await this.trySendTelemetry((async()=>{this.pageHandlerModuleInstance.RecordAsUserAction(t)}),`Action:${t}`,e)}async sendEngagementTelemetry(t,e,i=!0){await this.trySendTelemetry((async()=>{this.pageHandlerModuleInstance.RecordAsUserEngagement(t,e)}),`Engagement:${t}`,i)}async logButtonClickTelemetry(t,e,i,n,o=!0,r){await this.trySendTelemetry((async()=>{const o=new ci(e,this.telemetryUtilitiesInstance.setContentViewed(r??tt.INBOX_COUPONS),void 0,JSON.stringify(Lq(Lq({},i??{}),await this.getCommonMetaData(t,r))));this.logModuleInstance.LogInfoEvent(p.ButtonClick,`${e} has been clicked.`+(n?` ${n}`:""),o),await new Promise((t=>{const e=setTimeout((()=>{t(),clearTimeout(e)}),100)}))}),`${p.ButtonClick}:${e}`,o)}async logClientErrorTelemetry(t,e,i,n=!0){await this.trySendTelemetry((async()=>{const n=new u(t,void 0,void 0,void 0,JSON.stringify(Lq(Lq({},i??{}),await this.getCommonMetaData())));this.logModuleInstance.LogErrorEvent(p.EdgeFlyoutStatus,`[InboxCoupons][ERROR][${e.name}]: ${e.message}`,n)}),`${p.ClientError}: ${e.name}`,n)}async logClientInfoTelemetry(t,e,i,n=!0){await this.trySendTelemetry((async()=>{const n=new u(t,void 0,void 0,void 0,JSON.stringify(Lq(Lq({},i??{}),await this.getCommonMetaData())));this.logModuleInstance.LogInfoEvent(p.EdgeFlyoutStatus,`[InboxCoupons][INFO]: ${e}`,n)}),`${p.EdgeFlyoutStatus}: ${e}`,n)}async getCommonMetaData(t,e){const i=this.getAuthInfoInstance?await this.getAuthInfoInstance():{},n=e??(t&&await(async t=>{for(const e of Object.keys(wq)){const i=document.getElementById(Nq[e]);if(i?.contains(t))return e}})(t)),o=n&&this.getModuleInfoHandlers[n]?await this.getModuleInfoHandlers[n]():{},r=(await this.pageHandlerModuleInstance.GetEdgeAnid(!0)).anid;return Lq({userIdentifier:r&&await Mq(`anid:${r}`),email:i.email&&await Mq(i.email),module:o.moduleName,shoppingTab:o.shoppingTab,route:o.route},this.getEnvMetadata())}getEnvMetadata(){const t=this.flyoutDataInstance.common.userCountryCode,e=this.flyoutDataInstance.common.browseMode,i=this.flyoutDataInstance.common.channel;return{environment:this.environment,language:sX.getBrowserLanguage(),userCountryCode:t,browseMode:e,channel:i}}async trySendTelemetry(t,e,i=!0){try{await t()}catch(t){i&&(t.message=`[InboxCoupons][ERROR] Error in recording a telemetry${e}\n${t.message}`,await this.logClientErrorTelemetry(C.ErrorToRecordTelemetry,t,void 0,!1))}}}i(Bq,"instance",void 0);const Fq=Bq.Instance;let Uq=function(t){return t.V1="v1",t.V2="v2",t.Unknown="vUnknown",t}({});class Hq{static isRecentCoupon(t){return(Date.now()-t.messageReciptionDate.getTime())/864e5<=Gq}static getRetailerSubtitleText(t,e){const i=t.length,n=t.filter(Hq.isRecentCoupon).length;return n>0?1===n?Me.GetICUPluralString(e.strings.recentCoupons,M.One):Me.GetICUPluralString(e.strings.recentCoupons,M.Other,n):i>0?1===i?Me.GetICUPluralString(e.strings.couponsCount,M.One):Me.GetICUPluralString(e.strings.couponsCount,M.Other,i):e.strings.noCouponsFound}static getRetailerAriaLabelText(t,e,i){const n=e.length,o=e.filter(Hq.isRecentCoupon).length;return o>0?1===o?Me.ReplaceValueInKey("retailerSentYouOneRecentCoupon",i.strings.retailerSentYouOneRecentCoupon,t):Me.ReplaceValueInKey("retailerSentYouNRecentCoupons",i.strings.retailerSentYouNRecentCoupons,t,`${o}`):n>0?1===n?Me.ReplaceValueInKey("retailerSentYouOneCoupon",i.strings.retailerSentYouOneCoupon,t):Me.ReplaceValueInKey("retailerSentYouNCoupons",i.strings.retailerSentYouNCoupons,t,`${n}`):Me.ReplaceValueInKey("retailerSentYouZeroCoupon",i.strings.retailerSentYouZeroCoupon,t)}constructor(t,e,n,o){i(this,"couponCode",void 0),i(this,"senderDomain",void 0),i(this,"messageReciptionDate",void 0),i(this,"new",void 0),this.couponCode=t,this.messageReciptionDate=new Date(e.toString()),this.senderDomain=n,this.new=o}}const Gq=14;var Vq=Hq;class jq{constructor(t){i(this,"errorCode",void 0),i(this,"retailerId",void 0),i(this,"retailerName",void 0),i(this,"coupons",void 0),this.errorCode=t?.errorCode??"Failed",this.retailerId=t?.retailerId??"",this.retailerName=t?.retailerName??"",this.coupons=t?.coupons?.map((t=>new Vq(t.couponCode,t.messageReciptionDate,t.senderDomain,t.new)))??[],this.filterOlderCoupons()}filterOlderCoupons(){this.coupons=this.coupons.filter(Vq.isRecentCoupon)}}var $q=function(t){return t.OK="OK",t.NotSupportedDomain="NotSupportedDomain",t.Failed="Failed",t}($q||{});const Wq=(t,e)=>`${t}|${e}`;var zq=class{constructor(t,e,n){i(this,"id",void 0),i(this,"name",void 0),i(this,"senderDomains",void 0),this.id=t,this.name=e,this.senderDomains=n}getDisabledRetailerSendersKeys(t){return this.senderDomains||(this.senderDomains=t),this.senderDomains.map((t=>Wq(this.id,t)))}};var Kq=class{constructor(t,e,n){i(this,"retailerId",void 0),i(this,"retailerName",void 0),i(this,"coupons",void 0),this.retailerId=t,this.retailerName=e,this.coupons=n.map((t=>new Vq(t.couponCode,t.messageReciptionDate,t.senderDomain,t.new)))}};var Yq=class{constructor(t){i(this,"retailers",void 0),i(this,"disabledRetailers",void 0),this.retailers=t?.retailers?.map((t=>new Kq(t.retailerId,t.retailerName,t.coupons)))??[],this.disabledRetailers=t?.disabledRetailers?.map((t=>new zq(t.id,t.name,t.senderDomains)))??[]}};class qq{constructor(){}static get Instance(){return this.instance||(this.instance=new this)}async getAllCoupons(t,e){try{if(!t)throw new Error("Empty userId!");const i=await fetch(new URL("allUserCoupons",qq.INBOX_COUPONS_SERVICE_BASE_URL).href,{method:"POST",headers:this.getCommonRequestHeaders(e,t)});if(200!==i.status)throw new Error(`Request failed with status code ${i.status}`);const n=await i.json();return new Yq(n?.inboxCoupons)}catch(t){return t.message=`[InboxCoupons][AllCouponsAPICall] ${t.message}, can't retreive your coupons and we will show the cached coupons`,null}}async getUserEmailsStatus(t,e){try{if(!t)throw new Error("Empty userId!");const i=await fetch(new URL("emails/status",qq.INBOX_COUPONS_SERVICE_BASE_URL).href,{method:"GET",headers:this.getCommonRequestHeaders(e,t)});if(404===i.status)return{};if(200!==i.status)throw new Error(`Request failed with status code ${i.status}`);return await i.json()}catch(t){return t.message=`[InboxCoupons][UserEmailsStatusAPICall] ${t.message}, can't retreive your emails status`,{error:t}}}async deleteEmail(t,e,i){if(!t||!e)return!1;let n;try{return n=await fetch(new URL(`emailId/${e}`,qq.INBOX_COUPONS_SERVICE_BASE_URL).href,{method:"POST",headers:this.getCommonRequestHeaders(i,t)}),200===n.status}catch(t){return!1}}async getDomainCoupons(t,e,i){if(!t||!e)return null;const n={domain:e};let o;try{if(o=await fetch(new URL("coupons",qq.INBOX_COUPONS_SERVICE_BASE_URL).href,{method:"POST",headers:this.getCommonRequestHeaders(i,t),body:JSON.stringify(n)}),200!==o.status)return null;const e=await o.json(),r=new jq(e);return r.errorCode===$q.OK?r:null}catch(t){return null}}async updateUserDisabledRetailer(t,e,i,n,o){if(!(t&&e&&i&&n))return!1;const r={retailerId:e,senderEmails:i,status:n,deleteCoupons:!1};let a;try{return a=await fetch(new URL("users",qq.INBOX_COUPONS_SERVICE_BASE_URL).href,{method:"POST",headers:this.getCommonRequestHeaders(o,t),body:JSON.stringify(r)}),200===a.status}catch(t){return!1}}getCommonRequestHeaders(t,e){const i=new Headers;return i.append("Authorization",`Bearer ${t}`),i.append("userid",e),i.append("Content-Type","application/json"),i}}i(qq,"instance",void 0),i(qq,"INBOX_COUPONS_SERVICE_BASE_URL","https://www.bing.com/api/shopping/v1/savings/inboxcoupons/");const Xq=qq.Instance;let Jq=function(t){return t.Coupons="coupons",t}({});const Zq=(0,VR.createContext)({commonAssets:{},flyoutData:{},inboxCouponsAssets:{},notificationText:"",pageHandlerModule:{},updateNotificationText:()=>{},utilities:{},logModule:{},stateManagement:{},isDarkMode:!1,moduleName:tt.INBOX_COUPONS}),Qq=t=>{const{commonAssets:e,flyoutData:i,inboxCouponsAssets:n,pageHandlerModule:o,logModule:r,stateManagement:a,utilities:s,telemetryUtilities:l,moduleName:c}=t;(0,VR.useEffect)((()=>{Fq.pageHandlerModule=o}),[o]),(0,VR.useEffect)((()=>{Fq.logModule=r}),[r]),(0,VR.useEffect)((()=>{Fq.flyoutData=i}),[i]),(0,VR.useEffect)((()=>{Fq.telemetryUtilities=l}),[l]);const d=(0,VR.useMemo)((()=>i.common.currentTheme===$.Dark),[i]),[u,h]=(0,VR.useState)(""),p=(0,VR.useCallback)((t=>h(t)),[]);return VR.createElement(Zq.Provider,{value:{commonAssets:e,flyoutData:i,inboxCouponsAssets:n,notificationText:u,pageHandlerModule:o,stateManagement:a,logModule:r,updateNotificationText:p,utilities:s,isDarkMode:d,moduleName:c}},t.children)};let tX=function(t){return t.Microsoft="Microsoft",t.Gmail="Gmail",t}({}),eX=function(t){return t.AuthenticationError="AuthenticationError",t.AuthorizationError="AuthorizationError",t.InvalidRequest="InvalidRequest",t.UnexpectedError="UnexpectedError",t.ReconnectingDifferentEmail="ReconnectingDifferentEmail",t.EmailConnectedToDifferentUser="EmailConnectedToDifferentUser",t.EmailBlocked="EmailBlocked",t}({});const iX=(0,VR.createContext)({edgeSignIn:void 0,anid:null,areAllEmailsActive:!0,authorizationError:null,clearAuthorizationError:void 0,deleteEmail:void 0,getEmailProvider:void 0,googleLogin:void 0,isActiveEmail:void 0,isDisconnectedEmail:void 0,isAuthorizationLoading:!0,isAuthorized:!1,isEdgeSignedInUser:!1,microsoftLogin:void 0,userData:null,userEmails:void 0,isConnectingEmail:!1,refreshUserEmails:void 0}),nX=({children:t})=>{const{flyoutData:e,pageHandlerModule:i,stateManagement:n,moduleName:o}=(0,VR.useContext)(Zq),[r,a]=(0,VR.useState)(null),[s,l]=(0,VR.useState)(void 0),[c,d]=(0,VR.useState)(!0),[u,h]=(0,VR.useState)(null),p=(0,VR.useRef)(void 0),g=(0,VR.useMemo)((()=>{if(!r)return s?new _q(s.map((t=>t.id)),""):null;const t=oX(r);return new _q(t,r)}),[r,s,oX]);(0,VR.useEffect)((()=>{Fq.getAuthInfo=()=>({email:g?.emails[0]})}),[g]),(0,VR.useEffect)((()=>{r||0!==(s?.length??0)?i.SetStorageValue(Cn.InboxCouponsUserConsented,En.CreateFromString(Ee)):i.SetStorageValue(Cn.InboxCouponsUserConsented,En.CreateFromString(""))}),[r,s]);const[f,m]=(0,VR.useState)(null),y=(0,VR.useMemo)((()=>null!==g&&g.emails.length>0),[g]),v=(0,VR.useMemo)((()=>null!==f),[f]);(0,VR.useEffect)((()=>{(async()=>{if(i.IsMessageAllowed("getEdgeAnid")){const t=(await i.GetEdgeAnid(!0)).anid;m((t?.length??0)>0?t:null)}else m(null)})()}),[i]);const S=(0,VR.useCallback)((async()=>{const t=await i.GetStorageValue(`${Cn.InboxCouponsUserEmailsStatusCache}`);try{if((t?.value?.stringValue?.length??0)>0){return JSON.parse(t.value.stringValue)}return null}catch{return null}}),[i]);(0,VR.useEffect)((()=>{(async()=>{d(!0);const t=await i.GetStorageValue(`${Cn.InboxCouponsAuthTokenKeyPrefix}${f}`);(t?.value?.stringValue?.length??0)>0&&a(t.value.stringValue),d(!1)})()}),[f,i]);const b=(0,VR.useCallback)((()=>h(null)),[h]),T=(0,VR.useMemo)((()=>{const t=[Jq.Coupons],i={userId:`anid:${f}`,market:e.common.userCountryCode,enabledScenarios:t};return JSON.stringify(i)}),[f,e]),A=(0,VR.useCallback)((t=>`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({access_type:"offline",client_id:"39807376480-r6c0iggtqrol4jvdlq3p7uvma7glapqc.apps.googleusercontent.com",include_granted_scopes:"true",prompt:"select_account consent",redirect_uri:e.common.googleAuthRedirectUrl,response_type:"code",scope:["https://www.googleapis.com/auth/gmail.readonly"].join(" "),state:T})}`),[T]),O=(0,VR.useCallback)((t=>`https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize?${new URLSearchParams({access_type:"offline",client_id:"d68e28a3-f122-463a-a4e2-e8d3d6427aee",include_granted_scopes:"true",prompt:t?"consent":"select_account",redirect_uri:e.common.microsoftAuthRedirectUrl,response_type:"code",scope:["https://graph.microsoft.com/user.read","https://graph.microsoft.com/mail.read","offline_access"].join(" "),state:T})}`),[T]),x=(0,VR.useCallback)((async(t=!0)=>{if(f){if(i.ClearStorageValue(Cn.InboxCouponsUserEmailsStatus),t){const t=await S();if(t&&t.expirationTime>(new Date).getTime())return void l(t.value.emails)}const e=await Xq.getUserEmailsStatus(f,"");if(e.error)l(void 0);else{l((e?.emails??[]).filter((t=>t)).map((t=>new kq(t.id,t.emailProvider,t.active))));const t=JSON.stringify({value:e,expirationTime:(new Date).getTime()+144e5});i.SetStorageValue(Cn.InboxCouponsUserEmailsStatusCache,En.CreateFromString(t))}}else l(void 0)}),[f,S,i]);(0,VR.useEffect)((()=>{x()}),[x]);const E=(0,VR.useCallback)((async t=>{if(e.common.authAllowedOrigins.has(t.origin)){I(!1),_(null);const o=t.data,r=((await i.GetStorageValue(`${Cn.InboxCouponsAuthTokenKeyPrefix}${f}`)).value?.stringValue?.length??0)>0;switch(i.SetStorageValue(Cn.InboxCouponsUserEmailsStatusCache,En.CreateFromString("")),o.status){case"success":if(i.SetStorageValue(`${Cn.InboxCouponsAuthTokenKeyPrefix}${f}`,En.CreateFromString(o.payload.jwt)),re(aX.InboxCouponsUserLoginDateInMs,`${(new Date).getTime()}`),await x(!1),a(o.payload.jwt),h(null),Fq.logClientInfoTelemetry(C.InboxCouponsEmailConnected,"Inbox coupons email connected",{isReconnect:r,emailProvider:p.current}),r)Fq.sendActionTelemetry(di.INBOX_COUPONS_RECONNECT_INBOX),Fq.sendEngagementTelemetry(Xe.INBOX_COUPONS_RECONNECT_INBOX,e.common.popupOrigination);else switch(p.current){case tX.Gmail:Fq.sendActionTelemetry(di.INBOX_COUPONS_CONNECT_GMAIL_INBOX),Fq.sendEngagementTelemetry(Xe.INBOX_COUPONS_CONNECT_GMAIL_INBOX,e.common.popupOrigination);break;case tX.Microsoft:Fq.sendActionTelemetry(di.INBOX_COUPONS_CONNECT_OUTLOOK_INBOX),Fq.sendEngagementTelemetry(Xe.INBOX_COUPONS_CONNECT_OUTLOOK_INBOX,e.common.popupOrigination)}n.dispatchEvent(new CustomEvent(dn.InboxCouponUserLoggedIn));break;case"error":h(o?.payload?.errorType??eX.UnexpectedError)}d(!1)}}),[f,e.common.authAllowedOrigins,i,x]);(0,VR.useEffect)((()=>{null!==u&&Fq.logClientErrorTelemetry(C.InboxCouponsEmailConnectError,new Error(u))}),[u]);const[P,I]=(0,VR.useState)(!1),[D,_]=(0,VR.useState)(null),k=(0,VR.useCallback)((t=>{window.removeEventListener("message",E);const e=window.open(t,"loginWindow","toolbar=no, menubar=no, width=600, height=700, top=100, left=100");e?.focus(),I(!0),_(e),window.addEventListener("message",E,!1)}),[E]);(0,VR.useEffect)((()=>{const t=setInterval((()=>{null===D||D.closed?(I(!1),clearInterval(t)):I(!0)}),500);return()=>clearInterval(t)}),[D]);const w=(0,VR.useCallback)((t=>{const e=A(t);p.current=tX.Gmail,k(e)}),[A,k]),N=(0,VR.useCallback)((t=>{const e=O(t);p.current=tX.Microsoft,k(e)}),[O,k]),M=(0,VR.useCallback)((async()=>{if(i.IsMessageAllowed("getEdgeAnid")){const t=(await i.GetEdgeAnid(!0)).anid,e=(t?.length??0)>0;return m(e?t:null),e}return!1}),[i]),{edgeSignIn:R}=((t,e,i,n,o)=>{const r=(0,VR.useMemo)((()=>void 0!==i?i.IsMessageAllowed("signInToEdgeProfile"):void 0),[i]),a=(0,VR.useMemo)((()=>void 0===r?Uq.Unknown:r?Uq.V2:Uq.V1),[r]),s=(0,VR.useCallback)((()=>""!==n.dataLoader.GetLoadTimeDataValue("aadEmail","")),[n]),l=(0,VR.useCallback)(((t,i)=>{let n=1;const o=()=>setTimeout((async()=>{const r=await e();n++,r&&t(r),!r&&n<=4&&o(),n>4&&i?.()}),1e3);o()}),[e,n,a]),c=(0,VR.useCallback)((async()=>{i.ClearStorageValue(Cn.InboxCouponsEdgeSignInStarted),i.ClearStorageValue(Cn.InboxCouponsEdgeSignInSuccess)}),[i]),d=(0,VR.useCallback)((()=>{Fq.logClientInfoTelemetry(C.InboxCouponsEdgeSignInSuccess,"User successfully logged in to Edge through Inbox coupons",{edgeSignInVersion:a}),Fq.sendActionTelemetry(di.INBOX_COUPONS_SIGN_IN_EDGE),Fq.sendEngagementTelemetry(Xe.INBOX_COUPONS_SIGN_IN_EDGE)}),[a]),u=(0,VR.useCallback)((()=>{Fq.logClientInfoTelemetry(C.InboxCouponsEdgeSignInSuccessWorkProfile,"User successfully logged in to Edge with work profile through Inbox coupons",{edgeSignInVersion:a})}),[a]),h=(0,VR.useCallback)((()=>{Fq.logClientInfoTelemetry(C.InboxCouponsEdgeSignInNotCompleted,"User didn't complete logging in to Edge through Inbox coupons",{edgeSignInVersion:a})}),[a]),p=(0,VR.useCallback)((t=>{Fq.logClientErrorTelemetry(C.InboxCouponsEdgeSignInError,t,{edgeSignInVersion:a})}),[a]),g=(0,VR.useCallback)(((t,e)=>{if(t){if(!e)return h(),void c();if(s())return u(),void c();l((()=>{o.dispatchEvent(new CustomEvent(dn.InboxCouponsEdgeUserSuccsefullySignedIn)),c()}),(()=>{c()}))}}),[h,u,l,o,c,s]);(0,VR.useEffect)((()=>{(async()=>{if(a===Uq.Unknown)return;if(t!==tt.INBOX_COUPONS)return;const[e,n]=await Promise.all([i.GetStorageValue(Cn.InboxCouponsEdgeSignInSuccess),i.GetStorageValue(Cn.InboxCouponsEdgeSignInStarted)]),[o,r]=[e?.value?.boolValue??!1,n?.value?.boolValue??!1];a===Uq.V1&&g(r,o)})()}),[t,i,a,g]);const f=(0,VR.useCallback)((()=>{l((t=>{t&&a!==Uq.V2&&d(),c()}))}),[l,d,c,a]),m=(0,VR.useCallback)((async t=>{try{i.SetStorageValue(Cn.InboxCouponsEdgeSignInStarted,Sn.CreateFromBool(!0)),(await i.SignIntoMSA(!0)).msaSignedIn&&(i.SetStorageValue(Cn.InboxCouponsEdgeSignInSuccess,Sn.CreateFromBool(!0)),t?.(),f())}catch(t){p(t)}}),[i,f,n,a,p]),y=(0,VR.useCallback)((async t=>{try{i.SetStorageValue(Cn.InboxCouponsEdgeSignInStarted,Sn.CreateFromBool(!0));const e=await i.SignInToEdgeProfile(!0),n=JSON.parse(e.result);n.canceled?h():n.error?p(new Error(n.error)):n.accountType&&("AAD"===n.accountType?(u(),o.dispatchEvent(new CustomEvent(dn.InboxCouponsEdgeUserWorkProfileSuccsefullySignedIn))):(d(),o.dispatchEvent(new CustomEvent(dn.InboxCouponsEdgeUserSuccsefullySignedIn))),t?.(),f())}catch(t){p(t)}}),[i,f,n,h,a,p,o]);return{edgeSignIn:(0,VR.useCallback)((async t=>(a===Uq.V2?y(t):m(t),a)),[a,m,y])}})(o,M,i,e,n),L=(0,VR.useCallback)((()=>{a(null),l(void 0),i.SetStorageValue(`${Cn.InboxCouponsAuthTokenKeyPrefix}${f}`,En.CreateFromString("")),i.SetStorageValue(Cn.InboxCouponsUserEmailsStatusCache,En.CreateFromString("")),ie(aX.InboxCouponsUserLoginDateInMs)}),[f,a,i]),B=(0,VR.useCallback)((t=>{if(void 0===s)return!1;const e=s?.filter((e=>e.id===t));return 0===e.length}),[s]),F=(0,VR.useCallback)((t=>{if(void 0===s)return!0;const e=s?.filter((e=>e.id===t));return 0===e.length&&L(),e[0]?.active??!1}),[s,L]),[U,H]=(0,VR.useState)(!0);(0,VR.useEffect)((()=>{(async()=>{const t=g?.emails?.map((t=>F(t)))??[],e=(await Promise.all(t)).reduce(((t,e)=>t&&e),!0);H(e)})()}),[g?.emails,F]);const G=(0,VR.useCallback)((async t=>{const i=await Xq.deleteEmail(f||"",t,r||"");return i&&(Fq.logClientInfoTelemetry(C.InboxCouponsEmailDisconnected,"Email disconnected"),Fq.sendActionTelemetry(di.INBOX_COUPONS_DISCONNECT_INBOX),Fq.sendEngagementTelemetry(Xe.INBOX_COUPONS_DISCONNECT_INBOX,e.common.popupOrigination),L(),n.dispatchEvent(new CustomEvent(dn.InboxCouponUserDisconnected))),Promise.resolve(i)}),[r,f,L]),V=(0,VR.useCallback)((t=>{const e=s?.filter((e=>e.id===t))[0]?.emailProvider??void 0;if(void 0!==e&&e in tX)return tX[e]}),[s]),j=(0,VR.useCallback)((()=>{L()}),[L]);(0,VR.useEffect)((()=>(n.removeEventListener(dn.InboxCouponUserDisconnected,j),n.addEventListener(dn.InboxCouponUserDisconnected,j),()=>{n.removeEventListener(dn.InboxCouponUserDisconnected,j)})),[j]);const $=(0,VR.useCallback)((async()=>{if(f){const t=await i.GetStorageValue(`${Cn.InboxCouponsAuthTokenKeyPrefix}${f}`);a((t?.value?.stringValue?.length??0)>0?t.value.stringValue:null)}}),[f,i]);return(0,VR.useEffect)((()=>(n.removeEventListener(dn.InboxCouponUserLoggedIn,$),n.addEventListener(dn.InboxCouponUserLoggedIn,$),()=>{n.removeEventListener(dn.InboxCouponUserLoggedIn,$)})),[$]),VR.createElement(iX.Provider,{value:{edgeSignIn:R,anid:f,areAllEmailsActive:U,authorizationError:u,clearAuthorizationError:b,deleteEmail:G,getEmailProvider:V,googleLogin:w,isActiveEmail:F,isDisconnectedEmail:B,isAuthorizationLoading:c,isAuthorized:y,isConnectingEmail:P,isEdgeSignedInUser:v,microsoftLogin:N,userData:g,userEmails:s,refreshUserEmails:x}},t)},oX=t=>{try{return JSON.parse(window.atob(t.split(".")[1])).emails??[]}catch{return[]}};class rX{static generateImgSrcFromSVGComponent(t){return`data:image/svg+xml;base64,${window.btoa(t)}`}static getEmailProviderFriendlyName(t,e){switch(t){case tX.Microsoft:return e.emailProviderMicrosoft;case tX.Gmail:return e.emailProviderGmail;default:return""}}static getBrowserLanguage(){return navigator.language?.split("-")?.[0]?.toLowerCase()??"Unknown"}static initStorageValues(t,e){this.SetHashedAnidStorageValue(t),this.SetPaneOpenStorageValue(t,e),this.SetInboxCouponsLogsMetadata(t,e)}static async SetHashedAnidStorageValue(t){let e="";t.IsMessageAllowed("getEdgeAnid")&&(e=(await t.GetEdgeAnid(!0)).anid);const i=await Mq(`anid:${e}`);t.SetStorageValue(Cn.InboxCouponsHashedUserId,En.CreateFromString(`${i}`))}static SetPaneOpenStorageValue(t,e){const i=e.common.isPane;t.SetStorageValue(Cn.InboxCouponsPaneOpen,En.CreateFromString(`${i}`))}static SetInboxCouponsLogsMetadata(t,e){Fq.flyoutData=e;const i=Fq.getEnvMetadata();t.SetStorageValue(Cn.InboxCouponsLogsMetadata,En.CreateFromString(JSON.stringify(i)))}}i(rX,"InboxCouponsVNextFlag","inboxCouponsVNext");let aX=function(t){return t.InboxCouponsUserLoginDateInMs="InboxCouponsUserLoginDateInMs",t}({});var sX=rX;let lX=function(t){return t[t.JSXElement=0]="JSXElement",t[t.SVGString=1]="SVGString",t[t.ImgSrcString=2]="ImgSrcString",t}({});var cX=class{constructor(t){i(this,"RootModuleWrapperHtmlId","inboxCouponSection"),i(this,"resourcesEndpoint",void 0),this.resourcesEndpoint=t}getStyles(){return`\n        html {\n            --inbox-coupon-hyperlink-color: #036AC4;\n            --inbox-coupon-card-background: #FFFFFF;\n            --inbox-coupon-card-title-color: #1A1A1A;\n            --inbox-coupon-card-description-color: #7A7A7A;\n            --inbox-coupon-card-footer-border-color: rgba(0, 0, 0, 0.04);\n            --inbox-coupon-selected-color: #036AC4;\n            --inbox-coupon-selected-border-color: #036AC433;\n            --inbox-coupon-new-badge-color: #C42B1C;\n            --inbox-coupon-new-badge-background-color: #F6F5F5;\n            --inbox-coupons-danger-color: #C42B1C;\n            --inbox-coupons-one-dot-background-color: #D7180C;\n            --inbox-coupons-one-dot-outline-color: transparent;\n            --inbox-coupon-progress-bar-track: #E0E0E0;\n            --inbox-coupon-button-border-color: #EFEFEF;\n            --inbox-coupon-error-message-background-color: #F3F3F3;\n            --inbox-coupons-scrollbar-color: #D5D5D5;\n            --inbox-coupons-button-background-color: #FBFBFB;\n            --inbox-coupons-button-border-color: #D6D6D6;\n            --inbox-coupons-card-border-color: #00000014;\n            --inbox-coupons-email-provider-container-background: #F3F4F6;\n            --inbox-coupons-spinner-border-gradient-colors: rgb(0, 120, 212) rgb(199, 224, 244) rgb(199, 224, 244);\n            --inbox-coupons-button-text-color: #1A1A1A;\n            --inbox-coupons-unchecked-toggle-button-background-color: rgb(243, 243, 243);\n            --inbox-coupons-checked-toggle-button-background-color: rgb(0, 120, 212);\n            --inbox-coupons-unchecked-toggle-button-border-color: rgb(117, 117, 117);\n            --inbox-coupons-checked-toggle-button-border-color: transparent;\n            --inbox-coupons-hovered-unchecked-toggle-button-background-color: rgb(243, 243, 243);\n            --inbox-coupons-hovered-unchecked-toggle-button-border-color: rgb(117, 117, 117);\n            --inbox-coupons-hovered-checked-toggle-button-border-color: rgb(50, 49, 48);\n            --inbox-coupons-hovered-checked-toggle-button-background-color: rgb(0, 90, 158);\n            --inbox-coupons-disabled-unchecked-toggle-button-background-color: rgb(243, 243, 243);\n            --inbox-coupons-disabled-unchecked-toggle-button-border-color: rgb(200, 198, 196);\n            --inbox-coupons-disabled-checked-toggle-button-background-color: rgb(200, 198, 196);\n            --inbox-coupons-disabled-checked-toggle-button-border-color: transparent;\n            --inbox-coupons-unchecked-toggle-indicator-background-color: rgb(117, 117, 117);\n            --inbox-coupons-hovered-unchecked-toggle-indicator-background-color: rgb(32, 31, 30);\n            --inbox-coupons-checked-toggle-indicator-background-color: rgb(243, 243, 243);\n            --inbox-coupons-hovered-checked-toggle-indicator-background-color: rgb(243, 243, 243);\n            --inbox-coupons-disabled-unchecked-toggle-indicator-background-color: rgb(200, 198, 196);\n            --inbox-coupons-disabled-checked-toggle-indicator-background-color: rgb(243, 242, 241);\n            --inbox-coupons-card-settings-button-background-color: rgb(231, 231, 231);\n            --inbox-coupons-card-settings-button-hover-background-color: rgba(231, 231, 231, 0.5);\n        }\n        #${this.RootModuleWrapperHtmlId} * {\n            font-family: 'Segoe UI','Roboto', Helvetica, Verdana, sans-serif;\n        }\n        `}getDarkModeStyles(){return"\n        html {\n            --inbox-coupon-hyperlink-color: #66CDFC;\n            --inbox-coupon-card-background: #424242;\n            --inbox-coupon-card-title-color: #FFFFFF;\n            --inbox-coupon-card-description-color: #E0E0E0;\n            --inbox-coupon-card-footer-border-color: #515151;\n            --inbox-coupon-selected-color: #40B3D0;\n            --inbox-coupon-selected-border-color: #40B3D033;\n            --inbox-coupon-new-badge-color: #ED8E85;\n            --inbox-coupon-new-badge-background-color: #333333;\n            --inbox-coupons-danger-color: #ED8E85;\n            --inbox-coupons-one-dot-background-color: #FAA69E;\n            --inbox-coupons-one-dot-outline-color: #4A4A4A;\n            --inbox-coupon-progress-bar-track: #595959;\n            --inbox-coupon-button-border-color: #5A5A5A;\n            --inbox-coupon-error-message-background-color: #333333;\n            --inbox-coupons-scrollbar-color: #717171;\n            --inbox-coupons-button-background-color: #424242;\n            --inbox-coupons-button-border-color: #6C6C6C;\n            --inbox-coupons-card-border-color: #00000014;\n            --inbox-coupons-email-provider-container-background: #4C4C4C;\n            --inbox-coupons-spinner-border-gradient-colors: rgb(65, 207, 242) rgb(199, 224, 244) rgb(199, 224, 244);\n            --inbox-coupons-button-text-color: #FFFFFF;\n            --inbox-coupons-unchecked-toggle-button-background-color: rgb(59, 59, 59);\n            --inbox-coupons-checked-toggle-button-background-color: rgb(65, 207, 242);\n            --inbox-coupons-unchecked-toggle-button-border-color: rgb(167, 167, 167);\n            --inbox-coupons-checked-toggle-button-border-color: transparent;\n            --inbox-coupons-hovered-unchecked-toggle-button-background-color: rgb(59, 59, 59);\n            --inbox-coupons-hovered-unchecked-toggle-button-border-color: rgb(255, 255, 255);\n            --inbox-coupons-hovered-checked-toggle-button-border-color: transparent;\n            --inbox-coupons-hovered-checked-toggle-button-background-color: rgb(0, 90, 158);\n            --inbox-coupons-disabled-unchecked-toggle-button-background-color: rgb(59, 59, 59);\n            --inbox-coupons-disabled-unchecked-toggle-button-border-color: rgb(40, 39, 38);\n            --inbox-coupons-disabled-checked-toggle-button-background-color: rgb(40, 39, 38);\n            --inbox-coupons-disabled-checked-toggle-button-border-color: transparent;\n            --inbox-coupons-unchecked-toggle-indicator-background-color: rgb(167, 167, 167);\n            --inbox-coupons-hovered-unchecked-toggle-indicator-background-color: rgb(244, 244, 244);\n            --inbox-coupons-checked-toggle-indicator-background-color: rgb(59, 59, 59);\n            --inbox-coupons-hovered-checked-toggle-indicator-background-color: rgb(59, 59, 59);\n            --inbox-coupons-disabled-unchecked-toggle-indicator-background-color: rgb(40, 39, 38);\n            --inbox-coupons-disabled-checked-toggle-indicator-background-color: rgb(49, 48, 47);\n            --inbox-coupons-card-settings-button-background-color: rgba(69, 69, 69, 0.7);\n            --inbox-coupons-card-settings-button-hover-background-color: rgb(69, 69, 69);\n        }\n        "}getIcon(t,e={},i=lX.ImgSrcString){if(t)try{if("string"==typeof t){if(i===lX.ImgSrcString)return`${this.resourcesEndpoint}${t}`}else if("object"==typeof t){if(i===lX.ImgSrcString)return`${this.resourcesEndpoint}${e.dark&&t.dark?t.dark:t.light}`}else{const n=VR.createElement(t,e);if(i===lX.JSXElement)return n;if(i===lX.SVGString)return Dq.renderToStaticMarkup(n);if(i===lX.ImgSrcString)return sX.generateImgSrcFromSVGComponent(Dq.renderToStaticMarkup(n))}}catch(t){}return null}getRetailerLogoUrl(t){return`${this.resourcesEndpoint}inboxCoupons/retailers/${t}.png`}scrollInboxCouponsModuleIntoView(t=!1){const e=document.getElementById(this.RootModuleWrapperHtmlId);if(e?.scrollIntoView({behavior:"smooth"}),t){const t=e?.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=t?.[0];i?.focus()}}};let dX=function(t){return t.Disable="Disable",t.Enable="Enable",t}({});const uX=(t,e,i,n)=>{(0,VR.useEffect)((()=>{(async()=>{const o=(await e.GetStorageValue(t))?.value?.stringValue??"";o.length>0&&(n(),e.ClearStorageValue(t),Fq.logClientInfoTelemetry(i,`${i} has been logged`,{traceId:o}))})()}),[e,n])};function hX(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function pX(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hX(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hX(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const gX=9e5;var fX=function(t){return t.Home="home",t.Login="login",t.Coupons="inbox-coupons",t.Settings="settings",t.NoCoupons="no-coupons",t.FindingOffers="finding-offers",t.RefreshingInboxCoupons="refreshing-inbox-coupons",t.AccessRevoked="access-revoked",t.ConnectingDifferentEmail="connecting-different-email",t}(fX||{});const mX=(0,VR.createContext)({activeRetailer:null,activeRoute:fX.Home,activeSettingsEmailAddress:"",activeSettingsRetailer:null,disabledRetailerSenders:new Set,getOrderedRetailers:()=>[],handleUserDisconnection:()=>{},isInboxCouponsInitialized:!1,isInboxCouponsLoading:!1,isRetailerSendersSettingsLoading:new Set,retailersCoupons:[],showAllRetailers:!1,toggleRetailerSenderPrivacySetting:(t,e,i)=>{},updateActiveRetailer:(t,e)=>{},updateActiveRoute:t=>{},updateActiveSettingsEmailAddress:t=>{},updateActiveSettingsRetailer:(t,e)=>{},updateShowAllRetailers:t=>{},loadInboxCoupons:t=>{},calculateFirstRunExperiencePercentage:()=>0,isFRECompleted:!1,isLoginCardExpanded:!1,setIsLoginCardExpanded:t=>{},focusedCouponKey:"",setFocusedCouponKey:t=>{}}),CX=t=>{const{flyoutData:e,inboxCouponsAssets:i,pageHandlerModule:n,stateManagement:o,updateNotificationText:r,utilities:a}=(0,VR.useContext)(Zq),{anid:s,isAuthorized:l,userData:c,isDisconnectedEmail:d}=(0,VR.useContext)(iX),[u,h]=(0,VR.useState)("true"===ee("inboxCouponsUpsellOpen")),p=(0,VR.useCallback)((()=>{h(!0),setTimeout((()=>{a.switchShoppingTab(yt.Home),i.scrollInboxCouponsModuleIntoView(!0),r(e.strings.loadedInboxCoupons)}),1e3)}),[a.switchShoppingTab,i.scrollInboxCouponsModuleIntoView,r,e.strings.loadedInboxCoupons]);uX(Cn.InboxCouponsAAFailureUpsellTriggeredV2,n,C.InboxCouponsAAFailureUpsellPaneModuleViewed,p),uX(Cn.InboxCouponsAASuccessUpsellTriggeredV2,n,C.InboxCouponsAASuccessUpsellPaneModuleViewed,p);const g=(0,VR.useCallback)((()=>{h(!0),a.switchShoppingTab(yt.Home),i.scrollInboxCouponsModuleIntoView()}),[a.switchShoppingTab,i.scrollInboxCouponsModuleIntoView]);(0,VR.useEffect)((()=>{o.addEventListener(dn.InboxCouponsEdgeUserSuccsefullySignedIn,g)}),[o,g]);const[f,m]=(0,VR.useState)(null),[y,v]=(0,VR.useState)(null),[S,b]=(0,VR.useState)(""),[T,A]=(0,VR.useState)([]),[O,x]=(0,VR.useState)(null),[E,P]=(0,VR.useState)(new Set),I=(0,VR.useCallback)((async(t,e,i)=>{D(i,t,e),k((i=>(i.add(Wq(t,e)),new Set(i))));await Xq.updateUserDisabledRetailer(s??"",t,[e],i?dX.Enable:dX.Disable,c?.authToken??"")||D(!i,t,e),k((i=>(i.delete(Wq(t,e)),new Set(i))))}),[s,c?.authToken]),D=(0,VR.useCallback)(((t,e,i)=>{P((n=>(t?n.delete(Wq(e,i)):n.add(Wq(e,i)),new Set(n))))}),[]),[_,k]=(0,VR.useState)(new Set),[w,N]=(0,VR.useState)(!1),[M,R]=(0,VR.useState)(!1),[L,B]=(0,VR.useState)(!1),F=(0,VR.useCallback)((t=>{const e=t?.retailers?.reduce(((t,e)=>{const i=new Set(e.coupons.map((t=>t.senderDomain)));return t[e.retailerId]=[...i],t}),{}),i=t?.disabledRetailers?.flatMap((t=>t.getDisabledRetailerSendersKeys(e[t.name]??[])))??[];P(new Set(i))}),[]),U=(0,VR.useCallback)((t=>[...t].sort(((t,e)=>t.name.toLocaleLowerCase()<e.name.toLocaleLowerCase()?-1:t.name.toLocaleLowerCase()>e.name.toLocaleLowerCase()?1:t.items.length<e.items.length?-1:1))),[]),H=(0,VR.useCallback)(((t,e)=>{let i=(t.retailers??[]).map((t=>({ariaLabel:"",items:t.coupons.map((e=>pX(pX({},e),{},{key:`${t.retailerId}|${e.couponCode}`,name:e.couponCode}))),key:t.retailerId,name:t.retailerName,id:t.retailerId})));return e&&(i=U(i)),i}),[]),G=(0,VR.useCallback)((async()=>{const t=(await n.GetStorageValue(Cn.InboxCouponsGetAllCouponsResponseCache))?.value?.stringValue??"";try{const e=JSON.parse(t);if(e&&e.expirationTime>(new Date).getTime()){return new Yq(e.value)}return null}catch{return null}}),[n]),V=(0,VR.useCallback)((t=>{const e={expirationTime:(new Date).getTime()+18e5,value:t},i=En.CreateFromString(JSON.stringify(e));n.SetStorageValue(Cn.InboxCouponsGetAllCouponsResponseCache,i)}),[n]),j=(0,VR.useCallback)((async(t=!1)=>{if(l){if(R(!0),r(e.strings.loadingInboxCoupons),!t&&$()>gX){const t=await G();if(null!==t)return r(e.strings.loadedInboxCoupons),x(t),R(!1),void N(!0)}const i=await Xq.getAllCoupons(s,c?.authToken);i&&(x(i),V(i)),R(!1),r(e.strings.loadedInboxCoupons)}N(!0)}),[s,l,c?.authToken,r,G,V]);(0,VR.useEffect)((()=>{j()}),[j]);const $=(0,VR.useCallback)((()=>{let t=+(ee(aX.InboxCouponsUserLoginDateInMs)??"");Number.isNaN(t)&&(t=0);return(new Date).getTime()-t}),[]);(0,VR.useEffect)((()=>{if(null===O)A([]),P(new Set);else{const t=H(O,L);A(t),F(O),t.length>0&&r(e.strings.inboxCouponsFound)}}),[O,L,F,H]);const W=(0,VR.useCallback)((t=>{t.forEach((t=>clearTimeout(t)))}),[]),z=(0,VR.useCallback)((()=>{const t=[];let e=0;for(let i=0;i<3;i++){e+=12e4*2**i;const n=setTimeout((async()=>{await j(!0)}),e);t.push(n)}return t}),[j]);(0,VR.useEffect)((()=>{if($()<=gX){const t=z(),e=()=>{W(t)};return o.addEventListener(dn.flyoutRefresh,e),()=>{o.removeEventListener(dn.flyoutRefresh,e),W(t)}}}),[$,z,W,o]);const K=(0,VR.useCallback)(((t,e)=>{m((i=>{const n=t?.id!==i?.id;return e?.(n),n?t:null}))}),[m]),Y=(0,VR.useCallback)((async(t,e)=>{const i=t?.id!==y?.id;await(e?.(i)),v(i?t:null)}),[y,v]),q=(0,VR.useCallback)((t=>{b((e=>e===t?"":t))}),[b]),X=(0,VR.useCallback)((t=>{B(t)}),[b]);(0,VR.useEffect)((()=>{b(c?.emails?.[0]??"")}),[c?.emails]);const[J,Z]=(0,VR.useState)(fX.Home),Q=(0,VR.useCallback)((t=>Z(t)),[Z]),tt=(0,VR.useCallback)((()=>{const t=Cn.InboxCouponsGetAllCouponsResponseCache;n.ClearStorageValue(t),K(null),v(null),b(""),x(null),R(!1),B(!1),nt(!1),r(""),Z(fX.Home)}),[s,n,r]),et=(0,VR.useCallback)((()=>{Q(fX.Settings),setTimeout((()=>i.scrollInboxCouponsModuleIntoView()),100)}),[i.scrollInboxCouponsModuleIntoView,Q]);(0,VR.useEffect)((()=>(o.addEventListener(dn.InboxCouponsOpenSettings,et),()=>{o.removeEventListener(dn.InboxCouponsOpenSettings,et)})),[et]),(0,VR.useEffect)((()=>{c?.emails?.[0]&&d?.(c?.emails?.[0])&&tt?.()}),[d,c,tt]);const[it,nt]=(0,VR.useState)(!1),ot=(0,VR.useCallback)((()=>{const t=Math.min(1,$()/132e3);return nt(t>=1),t}),[$]),[rt,at]=(0,VR.useState)("");return VR.createElement(mX.Provider,{value:{activeRetailer:f,activeRoute:J,activeSettingsEmailAddress:S,activeSettingsRetailer:y,disabledRetailerSenders:E,getOrderedRetailers:U,handleUserDisconnection:tt,isInboxCouponsInitialized:w,isInboxCouponsLoading:M,isRetailerSendersSettingsLoading:_,retailersCoupons:T,showAllRetailers:L,toggleRetailerSenderPrivacySetting:I,updateActiveRetailer:K,updateActiveRoute:Q,updateActiveSettingsEmailAddress:q,updateActiveSettingsRetailer:Y,updateShowAllRetailers:X,loadInboxCoupons:j,calculateFirstRunExperiencePercentage:ot,isFRECompleted:it,isLoginCardExpanded:u,setIsLoginCardExpanded:h,focusedCouponKey:rt,setFocusedCouponKey:at}},t.children)};function yX(){return yX=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},yX.apply(this,arguments)}const vX=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M2048 1088H250l787 787-90 90L6 1024 947 83l90 90-787 787h1798v128z"}));function SX(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function bX(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?SX(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SX(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const TX=(0,VR.forwardRef)(((t,e)=>{const{id:i,ariaLabel:n,buttonText:o,onClick:r,imageUrl:a,imageAltText:s,disabled:l,checked:c,styles:d}=t,u=bX(bX({},d?.button??{}),c?d?.buttonChecked??{}:{});return VR.createElement(AX,{id:i,style:d?.container},VR.createElement(OX,{onClick:l?void 0:r,isDisabled:l,checked:c,styles:u,hoverStyles:d?.buttonHovered??{},"aria-label":n,ref:e},a?VR.createElement(xX,{src:a,alt:s,"aria-hidden":!0,style:d?.logo}):VR.createElement(VR.Fragment,null),VR.createElement(EX,{style:d?.text},o)))})),AX=ZU.div`
	display: flex;
	align-items: center;
	flex-direction: column;
	width: 100%;
`,OX=ZU.button`
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    display: flex;
    justify-content: center;
    align-items: center;
	font-size: 14px;
	font-weight: 600;
	line-height: 20px;
	padding: 8px 0;
	color: var(--neutral-foreground-rest);
	border-radius: 0;
	position: relative;
    background-color: ${t=>t.checked?"var(--neutral-fill-hover)":"transparent"};
    border: none;
	width: 100%;
    ${({styles:t})=>t}

	&:hover {
		background-color: var(--neutral-fill-hover);
        ${({hoverStyles:t})=>t}
	}
	${t=>t.isDisabled?"\n\t    pointer-events: none;\n        cursor: not-allowed;\n        background-color: transparent;\n        opacity: 0.5;\n        ":""})
`,xX=ZU.img`
	width: 20px;
	height: 20px;
	margin-inline-end: 12px;
`,EX=ZU.div`
	color: var(--inbox-coupons-button-text-color);
    font-size: 14px;
    line-height: 20px;
`,PX=()=>{const{updateActiveRoute:t}=(0,VR.useContext)(mX),{flyoutData:e,updateNotificationText:i,utilities:n,inboxCouponsAssets:o,isDarkMode:r}=(0,VR.useContext)(Zq),a=(0,VR.useCallback)((async n=>{await Fq.logButtonClickTelemetry(n.target,g.InboxCouponsBack),t(fX.Coupons),i(`${Me.ReplaceValueInKey("inboxCouponsTabSwitched",e.strings.inboxCouponsTabSwitched,fX.Coupons.slice(1))}`)}),[t,i,e,n]),s=e.dataLoader.GetLoadTimeDataValue("is_rtl",!1);return VR.createElement(TX,{styles:IX,ariaLabel:e.strings.goBackToCouponsTitle,onClick:a,buttonText:VR.createElement(DX,{"aria-hidden":!0},o.getIcon(vX,{dark:r,style:{fill:"var(--neutral-foreground-rest)",width:"16px",height:"16px",transform:s?"rotate(180deg)":"rotate(0deg)"}},lX.JSXElement))})},IX={container:{width:"32px",marginTop:"-4px"},button:{alignItems:"center",display:"flex",justifyContent:"center",padding:0,height:"32px"},text:{lineHeight:"0"}},DX=ZU.div`
  position: relative;
  fill: var(--neutral-foreground-rest);
`,_X={light:"common/infoIcon.svg",dark:"common/infoIcon.svg"};function kX(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}const wX=["horizontal","horizontalAlign","verticalAlign","tokens","styles","children"],NX=t=>{const{horizontal:e,horizontalAlign:i,verticalAlign:n,tokens:o,styles:r,children:a}=t,s=kX(t,wX);return VR.createElement(MX,yX({flexDirection:e?"row":"column",justifyContent:i,alignItems:n,padding:o?.padding,childrenGap:o?.childrenGap,styles:r?.root??{}},s),a)},MX=ZU.div`
    display: flex;
    flex: 1 1 0;
    flex-direction: ${t=>t.flexDirection};
    justify-content: ${t=>t.justifyContent??"normal"};
    align-items: ${t=>t.alignItems??"normal"};
    padding: ${t=>t.padding??"0"};

    > :not(:first-child) {
        ${t=>"column"===t.flexDirection||"column-reverse"===t.flexDirection?`margin-block-start: ${t.childrenGap??0}px`:""};
        ${t=>"column"!==t.flexDirection&&"column-reverse"!==t.flexDirection?`margin-inline-start: ${t.childrenGap??0}px`:""};
    }

    ${({styles:t})=>t}
`,RX=ZU.h2`
    margin-top: 9px;
    margin-bottom: 12px;
    font-size: 18px;
    line-height: 24px;
    font-weight: 600;
    color: var(--neutral-foreground-rest);
`,LX=ZU.a`
    display: flex;
    margin-top: 1px;
`;var BX=t=>{const{heading:e,leftActions:i,rightActions:n,body:o,infoIcon:r}=t,{inboxCouponsAssets:a,isDarkMode:s}=(0,VR.useContext)(Zq);return VR.createElement(NX,{tokens:{padding:"0px 20px 20px 20px"}},e||i||n?VR.createElement(NX,{horizontal:!0,horizontalAlign:n?"space-between":"start",verticalAlign:"center"},e||i?VR.createElement(VR.Fragment,null,VR.createElement(NX,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:9}},i??VR.createElement(VR.Fragment,null),VR.createElement(NX,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:6}},VR.createElement(RX,null,e),r&&VR.createElement(LX,{href:r.url,title:r.title,target:"_blank",onClick:async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsLearnMoreInfo,r.metadata)}},VR.createElement("img",{src:a.getIcon(_X,{dark:s})})))),n??VR.createElement(VR.Fragment,null)):VR.createElement(VR.Fragment,null)):VR.createElement(VR.Fragment,null),o)};const FX=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M1297 38q166 45 304 140t237 226 155 289 55 331q0 141-36 272t-103 245-160 207-208 160-245 103-272 37q-141 0-272-36t-245-103-207-160-160-208-103-244-37-273q0-140 37-272t105-248 167-212 221-164H256V0h512v512H640V215q-117 56-211 140T267 545 164 773t-36 251q0 123 32 237t90 214 141 182 181 140 214 91 238 32q123 0 237-32t214-90 182-141 140-181 91-214 32-238q0-150-48-289t-136-253-207-197-266-124l34-123z"})),UX=()=>{const[t,e]=(0,VR.useState)(!1),[i,n]=(0,VR.useState)(!1),{loadInboxCoupons:o,isInboxCouponsLoading:r}=(0,VR.useContext)(mX),{flyoutData:a,inboxCouponsAssets:s,isDarkMode:l,updateNotificationText:c}=(0,VR.useContext)(Zq),{refreshUserEmails:d}=(0,VR.useContext)(iX),u=(0,VR.useRef)({}),h=(0,VR.useRef)(null);(0,VR.useEffect)((()=>()=>{h.current&&clearTimeout(h.current)}),[]),(0,VR.useEffect)((()=>{r&&u.current&&(u.current.style.animationDuration="0.5s",n(!0),u.current.getAnimations().forEach((t=>{t.cancel(),t.play()})))}),[r,u.current]);const p=(0,VR.useCallback)((()=>{u&&(r?u.current.getAnimations().forEach((t=>{t.cancel(),t.play()})):(u.current.style.animationDuration="0s",n(!1)))}),[r,n]),f=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsRefresh),c(a.strings.inboxCouponsReloadingCoupons),r||(e(!0),await Promise.allSettled([o?.(!0),d?.(!1)]),c(a.strings.inboxCouponsReloadedCoupons),h.current&&clearTimeout(h.current),h.current=setTimeout((()=>{e(!1)}),2e3))}),[r,e,o,d]);return VR.createElement(TX,{disabled:t||r||i,styles:HX,ariaLabel:a.strings.inboxCouponsReloadCoupons,onClick:f,buttonText:VR.createElement(GX,{ref:u,onAnimationEnd:p},s.getIcon(FX,{dark:l,style:{fill:"var(--neutral-foreground-rest)",width:"16px",height:"16px"}},lX.JSXElement))})},HX={container:{width:"32px"},button:{alignItems:"center",display:"flex",justifyContent:"center",padding:0,height:"32px"}},GX=ZU.div`
  position: relative;
  display: flex;
  fill: var(--neutral-foreground-rest);
  animation: 0s ease-in-out 0s 1 normal forwards running spin;

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,VX=(t,e,i)=>{(0,VR.useEffect)((()=>{if(!t)return;const n=t=>{e&&1===t.which&&e.current&&!e.current.contains(t.target)&&i()};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}}),[t,e])},jX={light:"inboxCoupons/common/Gmail_Logo_30X30_3X.png?02072023",dark:"inboxCoupons/common/Gmail_Logo_30X30_3X.png?02072023"},$X=t=>VR.createElement("svg",yX({width:"154",height:"138",viewBox:"0 0 154 138",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M151.101 137.512H18.369L13.7841 55.292H153.394L151.101 137.512Z",fill:"url(#paint0_linear_9_239)"}),VR.createElement("path",{d:"M13.7841 55.292L83.859 112.735L153.394 55.292",fill:"url(#paint1_linear_9_239)"}),VR.createElement("path",{d:"M138.736 67.401L140.093 11.266H24.7111L26.03 65.331L83.859 112.735L138.736 67.401Z",fill:"url(#paint2_linear_9_239)"}),VR.createElement("path",{d:"M124.694 11.266V0.630005H95.749C94.626 6.36501 89.804 10.774 83.868 11.266H81.651C75.713 10.773 70.891 6.36501 69.769 0.630005H43.151V11.266H24.712L25.093 27.958L139.66 28.628L140.094 11.266H124.694Z",fill:"url(#paint3_linear_9_239)"}),VR.createElement("path",{d:"M24.131 125.417C37.2814 125.417 47.942 114.756 47.942 101.606C47.942 88.4556 37.2814 77.795 24.131 77.795C10.9805 77.795 0.319946 88.4556 0.319946 101.606C0.319946 114.756 10.9805 125.417 24.131 125.417Z",fill:"url(#paint4_linear_9_239)"}),VR.createElement("path",{d:"M21.9611 96.063C21.9611 98.456 21.545 100.279 20.712 101.531C19.879 102.784 18.674 103.41 17.098 103.41C15.521 103.41 14.313 102.781 13.475 101.523C12.637 100.265 12.217 98.445 12.217 96.064C12.217 93.671 12.633 91.84 13.467 90.571C14.299 89.301 15.51 88.667 17.098 88.667C18.674 88.667 19.879 89.301 20.712 90.571C21.545 91.841 21.9611 93.67 21.9611 96.063ZM15.605 95.996C15.605 97.65 15.7169 98.775 15.9399 99.367C16.1649 99.96 16.549 100.256 17.098 100.256C17.623 100.256 17.995 99.957 18.213 99.359C18.431 98.761 18.5389 97.64 18.5389 95.997C18.5389 94.286 18.4339 93.143 18.2209 92.567C18.0089 91.991 17.634 91.703 17.098 91.703C16.549 91.703 16.1639 92.008 15.9399 92.617C15.7169 93.225 15.605 94.352 15.605 95.996ZM17.433 113.775L29.594 88.666H32.311L20.217 113.775H17.433ZM37.6281 106.429C37.6281 108.822 37.2111 110.644 36.3781 111.897C35.5451 113.15 34.334 113.775 32.746 113.775C31.181 113.775 29.978 113.146 29.141 111.888C28.303 110.631 27.8831 108.811 27.8831 106.429C27.8831 104.036 28.2991 102.208 29.1331 100.944C29.9651 99.681 31.17 99.048 32.746 99.048C34.334 99.048 35.5451 99.677 36.3781 100.935C37.2111 102.193 37.6281 104.024 37.6281 106.429ZM31.3051 106.462C31.3051 108.15 31.41 109.283 31.623 109.858C31.836 110.434 32.21 110.722 32.746 110.722C33.295 110.722 33.678 110.417 33.895 109.807C34.113 109.198 34.222 108.082 34.222 106.461C34.222 104.784 34.113 103.643 33.895 103.04C33.677 102.436 33.294 102.134 32.746 102.134C32.221 102.134 31.85 102.436 31.631 103.04C31.415 103.644 31.3051 104.785 31.3051 106.462Z",fill:"white"}),VR.createElement("path",{d:"M18.71 137.351L84.201 112.575L151.443 137.351H18.71Z",fill:"url(#paint5_linear_9_239)"}),VR.createElement("path",{d:"M39.071 30.264H25.293L25.1021 26.013H38.788L39.071 30.264Z",fill:"white"}),VR.createElement("path",{d:"M62.783 30.264H49.004L48.814 26.013H62.5L62.783 30.264Z",fill:"white"}),VR.createElement("path",{d:"M87.917 30.264H74.139L73.948 26.013H87.6331L87.917 30.264Z",fill:"white"}),VR.createElement("path",{d:"M112.102 30.264H98.324L98.1331 26.013H111.819L112.102 30.264Z",fill:"white"}),VR.createElement("path",{d:"M139.707 30.264H124.026L123.809 26.013H139.764L139.707 30.264Z",fill:"white"}),VR.createElement("path",{d:"M42.5551 41.544L43.483 79.611L46.488 82.074L45.635 44.253H120.713L119.833 83.551L122.837 81.068L123.793 41.544H42.5551Z",fill:"url(#paint6_linear_9_239)"}),VR.createElement("path",{d:"M84.653 53.464C73.214 53.464 63.9399 68.272 63.9399 86.539C63.9399 90.322 64.342 93.952 65.075 97.337L83.859 112.735L104.569 95.627C105.085 92.738 105.367 89.692 105.367 86.539C105.367 68.272 96.092 53.464 84.653 53.464Z",fill:"url(#paint7_linear_9_239)"}),VR.createElement("defs",null,VR.createElement("linearGradient",{id:"paint0_linear_9_239",x1:"13.7838",y1:"96.4023",x2:"153.394",y2:"96.4023",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{offset:"0.0121","stop-color":"#A3FAF2"}),VR.createElement("stop",{offset:"0.3879","stop-color":"#7EEDC7"}),VR.createElement("stop",{offset:"1","stop-color":"#0D8FA7"})),VR.createElement("linearGradient",{id:"paint1_linear_9_239",x1:"13.7838",y1:"84.0137",x2:"153.394",y2:"84.0137",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#3B59D6"}),VR.createElement("stop",{offset:"1","stop-color":"#6118BD"})),VR.createElement("linearGradient",{id:"paint2_linear_9_239",x1:"82.4019",y1:"97.0972",x2:"82.4019",y2:"133.085",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#D0EBED"}),VR.createElement("stop",{offset:"0.4061","stop-color":"#7ED9C4"}),VR.createElement("stop",{offset:"1","stop-color":"#2B80A1"})),VR.createElement("linearGradient",{id:"paint3_linear_9_239",x1:"82.4019",y1:"1.1392",x2:"82.4019",y2:"19.5422",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#037EE3"}),VR.createElement("stop",{offset:"1","stop-color":"#0D8FA7"})),VR.createElement("linearGradient",{id:"paint4_linear_9_239",x1:"0.320746",y1:"101.606",x2:"47.9419",y2:"101.606",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#3B59D6"}),VR.createElement("stop",{offset:"1","stop-color":"#6118BD"})),VR.createElement("linearGradient",{id:"paint5_linear_9_239",x1:"18.7104",y1:"124.963",x2:"151.443",y2:"124.963",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#3B59D6"}),VR.createElement("stop",{offset:"1","stop-color":"#6118BD"})),VR.createElement("linearGradient",{id:"paint6_linear_9_239",x1:"83.1743",y1:"62.5303",x2:"83.1743",y2:"6.94129",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#2B88D8"}),VR.createElement("stop",{offset:"1","stop-color":"#80EBB8"})),VR.createElement("linearGradient",{id:"paint7_linear_9_239",x1:"84.6537",y1:"114.435",x2:"84.6537",y2:"42.9399",gradientUnits:"userSpaceOnUse"},VR.createElement("stop",{"stop-color":"#2B88D8"}),VR.createElement("stop",{offset:"1","stop-color":"#80EBB8"})))),WX=()=>VR.createElement(zX,null),zX=ZU.span`
    display: block;
    width: 6px;
    height: 6px;

    border-radius: 50%;
    outline: 1px solid var(--inbox-coupons-one-dot-outline-color);
    background-color: var(--inbox-coupons-one-dot-background-color);
`,KX={light:"inboxCoupons/common/Outlook_Logo_30X30_3X.png?02072023",dark:"inboxCoupons/common/Outlook_Logo_30X30_3X.png?02072023"},YX=t=>VR.createElement("svg",yX({width:"14",height:"4",viewBox:"0 0 14 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M3.25 2C3.25 2.69036 2.69036 3.25 2 3.25C1.30964 3.25 0.75 2.69036 0.75 2C0.75 1.30964 1.30964 0.75 2 0.75C2.69036 0.75 3.25 1.30964 3.25 2ZM8.25 2C8.25 2.69036 7.69036 3.25 7 3.25C6.30964 3.25 5.75 2.69036 5.75 2C5.75 1.30964 6.30964 0.75 7 0.75C7.69036 0.75 8.25 1.30964 8.25 2ZM12 3.25C12.6904 3.25 13.25 2.69036 13.25 2C13.25 1.30964 12.6904 0.75 12 0.75C11.3096 0.75 10.75 1.30964 10.75 2C10.75 2.69036 11.3096 3.25 12 3.25Z"})),qX=t=>VR.createElement("svg",yX({width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M5.99998 2.05058L10.3914 6.44194C10.6354 6.68602 11.0312 6.68602 11.2753 6.44194C11.5193 6.19787 11.5193 5.80214 11.2753 5.55806L11.2753 5.55806L6.4419 0.724747C6.19782 0.480665 5.80214 0.480665 5.55806 0.724747L0.724726 5.55806C0.480641 5.80213 0.480641 6.19787 0.724726 6.44194C0.968807 6.68602 1.36448 6.68602 1.60857 6.44194L5.99998 2.05058Z","stroke-width":"0.25"}));function XX(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function JX(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?XX(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XX(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const ZX=t=>{const{ariaLabel:e,title:i,titleTooltip:n,subtitle:o,collapsable:r,imageUrl:a,imageAlt:s,fallbackImageUrl:l,expanded:c,styles:d,onClick:u}=t,{isDarkMode:h,inboxCouponsAssets:p}=(0,VR.useContext)(Zq);return VR.createElement(NX,{horizontal:!0,verticalAlign:"center",style:d?.root,"aria-label":e,onClick:u},(!!a||!!l)&&VR.createElement(QX,{style:d?.logoContainer,"aria-hidden":!0},VR.createElement(tJ,{src:a,onError:({currentTarget:t})=>{t.onerror=null,t.src=l??""},alt:s,style:d?.logo})),VR.createElement(NX,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",styles:{root:{flex:1}}},VR.createElement(eJ,{style:d?.details},VR.createElement(iJ,{style:d?.title,title:n??""},i),VR.createElement(nJ,{style:d?.subtitle},o)),r&&VR.createElement(oJ,null,p.getIcon(qX,{dark:h,style:JX({fill:"var(--neutral-foreground-rest)",stroke:"var(--neutral-foreground-rest)",transition:"all 0.3s ease-in-out"},JX(c?{}:{transform:"rotate(180deg)"},d?.chevronIcon??{}))},lX.JSXElement))))},QX=ZU.div`
  display: flex;
  padding: 2px 0;
`,tJ=ZU.img`
    width: 40px;
    height: 100%;
    min-height: 40px;
    border-radius: 3px;
`,eJ=ZU(NX)`
    flex: 1;
    overflow: hidden;
`,iJ=ZU.h4`
    color: var(--neutral-foreground-rest);
    margin: 0;
    flex: 1;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;

    font-size: 14px;
    line-height: 20px;
    font-weight: 600;
`,nJ=ZU.p`
    margin: 0;
    color: var(--neutral-foreground-hint);
    max-width: 85%;

    font-size: 12px;
    line-height: 16px;
    font-weight: 400;
`,oJ=ZU.div`
    width: 9px;
    display: flex;
    margin-inline-end: 8px;
`,rJ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M1939 467l90 90-1005 1005L19 557l90-90 915 915 915-915z"})),aJ=ZU.a`
  color: var(--inbox-coupon-hyperlink-color);
  cursor: pointer;
  text-decoration: underline;
`,sJ=ZU.button`
  background: none;
  border: none;
  padding: 0;
  color: var(--inbox-coupon-hyperlink-color);
  cursor: pointer;
  text-decoration: underline;
`,lJ=ZU.button`
  display: flex;
  justify-content: center;
  align-items: center;

  cursor: pointer;
  border: calc(var(--stroke-width) * 1px) solid transparent;
  border-radius: 8px;

  margin-top: 8px !important;
  padding: 8px;

  font-family: inherit;
  font-size: 14px;
  color: var(--neutral-foreground-rest);
  background: padding-box linear-gradient(var(--neutral-fill-rest), var(--neutral-fill-rest)), border-box var(--neutral-stroke-control-rest);

  transition: box-shadow 500ms;
  &:hover {
    box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.12);
  }
`,cJ=t=>{const{onClick:e,title:i,text:n,isDarkMode:o,className:r,inboxCouponsAssets:a}=t;return VR.createElement(lJ,{onClick:e,title:i,className:r},n,a.getIcon(rJ,{dark:o,style:{fill:"var(--neutral-foreground-rest)",margin:"2px 10px 0 10px",width:"10px",stroke:"var(--neutral-foreground-rest)",strokeWidth:"150"}},lX.JSXElement))},dJ=ZU(cJ)`
  width: 100%;
  margin: 0 !important;
  padding: 12px 8px;
  background-color: transparent;
  color: var(--neutral-foreground-hint);
  border: none;
  background: none;

  &:hover {
    box-shadow: none;
  }
`,uJ=t=>{const{text:e,ariaLabel:i}=t;return VR.createElement(hJ,{"aria-label":i},VR.createElement(pJ,null,e))},hJ=ZU.div`
    color: var(--inbox-coupon-new-badge-color);
    background-color: var(--inbox-coupon-new-badge-background-color);
    padding: 2px 4px;

    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.08);
    border-radius: 2px;

    width: 29px;
    height: 14px;

    display: flex;
    justify-content: center;
    align-items: center;
`,pJ=ZU.span`
  height: 10px;
  font-size: 10px;
  line-height: 10px;
  font-weight: 600;
`,gJ=(ZU.div`
  font-weight: 600;
  font-size: 14px;
  line-height: 20px;
  color: var(--neutral-foreground-hint);
`,t=>{const{onClick:e}=t,{flyoutData:i,isDarkMode:n,inboxCouponsAssets:o}=(0,VR.useContext)(Zq),{areAllEmailsActive:r,userEmails:a}=(0,VR.useContext)(iX),s=`inboxCouponsSettingsButtonId-${Math.floor(1e7*Math.random())}`,l=i.dataLoader.GetLoadTimeDataValue("is_rtl",!1),[c,d]=(0,VR.useState)(!1),u=(0,VR.useCallback)((()=>d((t=>!t))),[]),h=(0,VR.useRef)(null);return VX(c,h,(()=>d(!1))),VR.createElement(mJ,{ref:h},VR.createElement(TX,{id:s,styles:fJ,ariaLabel:r?i.strings.goToInboxCouponsSettingsTitle:i.strings.actionRequiredInSettingsTitle,onClick:u,checked:c,buttonText:VR.createElement(CJ,null,o.getIcon(YX,{dark:n,style:{fill:"var(--neutral-foreground-rest)"}},lX.JSXElement),!r&&VR.createElement(yJ,null,VR.createElement(WX,null)))}),c&&VR.createElement(vJ,{role:"dialog",isRtl:l},a?.map(((t,r)=>VR.createElement(VR.Fragment,null,r>0&&VR.createElement("hr",{className:"sectionSeparator","aria-hidden":"true"}),VR.createElement(ZX,{ariaLabel:t.id,collapsable:!1,fallbackImageUrl:o.getIcon($X,{dark:n}),imageAlt:Me.ReplaceValueInKey("commonAriaLogo",i.strings.commonAriaLogo,t.emailProvider??""),imageUrl:o.getIcon(t.emailProvider===tX.Microsoft?KX:t.emailProvider===tX.Gmail?jX:null,{dark:n})||o.getIcon($X,{dark:n}),subtitle:VR.createElement("div",null,VR.createElement(bJ,{title:t.id,isDarkMode:n},t.id),VR.createElement(TJ,{onClick:e,tabIndex:0},i.strings.settings)),title:sX.getEmailProviderFriendlyName(t.emailProvider,i.strings),styles:SJ}))))))}),fJ={container:{width:"32px"},button:{alignItems:"center",display:"flex",justifyContent:"center",padding:0,height:"32px",borderRadius:"5px"},buttonChecked:{backgroundColor:"var(--inbox-coupons-card-settings-button-background-color)"},buttonHovered:{backgroundColor:"var(--inbox-coupons-card-settings-button-hover-background-color)"}},mJ=ZU.div`
  position: relative;
`,CJ=ZU.div`
  position: relative;
  fill: var(--neutral-foreground-rest);
  display: flex;
`,yJ=ZU.div`
  position: absolute;
  right: -6px;
  top: -6px;
`,vJ=ZU.div`
  width: 240px;
  box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.12);
  border-radius: 8px;
  background-color: var(--inbox-coupon-card-background);
  z-index: 9;
  position: absolute;
  margin-top: 3px;
  ${t=>t.isRtl?"left: 0;":"right: 0;"}

  animation: 0.2s ease-in-out 0s 1 normal forwards running slideUpFade;

  @keyframes slideUpFade {
    0% { top: calc(100% + 20px); opacity: 0; }
    100% { top: 100%; opacity: 1; }
  }
`,SJ={root:{paddingTop:"16px",paddingBottom:"16px",paddingInlineStart:"12px",paddingInlineEnd:"6px"},logoContainer:{alignItems:"center",backgroundColor:"var(--inbox-coupons-email-provider-container-background)",borderRadius:"50%",display:"flex",justifyContent:"center",height:"60px",width:"60px",aspectRatio:"1",padding:"0"},logo:{width:"32px",height:"32px",minHeight:"auto"},title:{fontSize:"14px",lineHeight:"20px",color:"var(--neutral-foreground-rest)",marginInlineStart:"12px",fontWeight:600},subtitle:{marginInlineStart:"12px",color:"var(--neutral-foreground-rest)",fontWeight:400}},bJ=ZU.span`
  display: block;
  font-size: 12px;
  line-height: 16px;
  overflow: hidden;
  text-overflow: ellipsis;
  color: "var(--neutral-foreground-rest)";
`,TJ=ZU(sJ)`
  font-size: 12px;
  line-height: 16px;
  margin-top: 3px;
  font-weight: 400;
`,AJ={container:{width:"32px"}};let OJ=function(t){return t[t.Previous=0]="Previous",t[t.Next=1]="Next",t}({});const xJ=t=>{const{activeSlideKey:e,infiniteLoop:i=!0,slidesKeys:n,onSlideChange:o,onSlideChangeClick:r,autoSlideChangeIntervalInSeconds:a,icons:s,isRtl:l,nextButtonAriaLabel:c,previousButtonAriaLabel:d,updateFirstFocusableElementRef:u}=t,h=(0,VR.useMemo)((()=>n.find((t=>t===e))),[n,e]),p=(0,VR.useCallback)((t=>{const i=n.findIndex((t=>t===e));let r=-1;switch(t){case OJ.Previous:r=0===i?n.length-1:i-1;break;case OJ.Next:r=i===n.length-1?0:i+1}o(n[r],r,e,i)}),[n,e]);(0,VR.useEffect)((()=>{if(a){const t=setInterval((()=>{(i||e!==n[n.length-1])&&p(OJ.Next)}),1e3*a);return()=>{clearInterval(t)}}}),[a,p,e]);const g=(0,VR.useCallback)((async(t,e)=>{await(r?.(t,e,h)),p(e)}),[p,h]),f=(0,VR.useRef)(null);return(0,VR.useEffect)((()=>{u?.(f)}),[f]),VR.createElement(VR.Fragment,null,h&&VR.createElement(NX,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},VR.createElement(TX,{onClick:t=>g(t,OJ.Previous),disabled:!i&&e===n[0],ariaLabel:d,buttonText:l?s.chevronRight:s.chevronLeft,styles:AJ,ref:f}),VR.createElement(NX,{horizontal:!0,horizontalAlign:"space-evenly",verticalAlign:"center",tokens:{padding:"0 10px"},styles:{root:{height:"100%"}}},n.map((t=>VR.createElement("div",{style:{display:"flex"},key:t},e===t?VR.createElement(VR.Fragment,null,s.circleFill):VR.createElement(VR.Fragment,null,s.circleRing))))),VR.createElement(TX,{onClick:t=>g(t,OJ.Next),disabled:!i&&e===n[n.length-1],ariaLabel:c,buttonText:l?s.chevronLeft:s.chevronRight,styles:AJ})))};var EJ=function(t){return t[t.Left=0]="Left",t[t.Right=1]="Right",t}(EJ||{});const PJ=t=>{const{slides:e,isAnimated:i,slideAnimationdurationInSeconds:n,infiniteLoop:o,autoSlideChangeIntervalInSeconds:r,isRtl:a,updateNotificationText:s,carouselControlsIcons:l,nextButtonAriaLabel:c,previousButtonAriaLabel:d,onSlideChangeClick:u,updateFirstFocusableElementRef:h}=t,[p,g]=(0,VR.useState)(0),f=(0,VR.useCallback)(((t,i,n,o)=>{g(i),0===i&&o===e.length-1||i>o&&(i!==e.length-1||0!==o)?C(a?EJ.Right:EJ.Left):C(a?EJ.Left:EJ.Right),e[i]&&s(e[i].announcedMessage??"")}),[e]),[m,C]=(0,VR.useState)(a?EJ.Right:EJ.Left),y=(0,VR.useMemo)((()=>e[p]),[e,p]);return VR.createElement(VR.Fragment,null,i?m===EJ.Right?VR.createElement(DJ,{key:wJ(p),slideAnimationdurationInSeconds:n??.4},y.content):VR.createElement(kJ,{key:wJ(p),slideAnimationdurationInSeconds:n??.4},y.content):VR.createElement(VR.Fragment,null,y.content),VR.createElement(xJ,{activeSlideKey:wJ(p),onSlideChange:f,slidesKeys:e?.map(((t,e)=>wJ(e)))??[],infiniteLoop:o,autoSlideChangeIntervalInSeconds:r,icons:l,nextButtonAriaLabel:c,previousButtonAriaLabel:d,onSlideChangeClick:u,updateFirstFocusableElementRef:h,isRtl:a}))},IJ=JU`
from {
  transform: translateX(-25%);
  opacity: 0;
}

to {
  transform: translateX(0%);
  opacity: 1;
}
`,DJ=ZU.div`
  animation: ${IJ} ${t=>t.slideAnimationdurationInSeconds}s ease-in-out;
`,_J=JU`
from {
  transform: translateX(25%);
  opacity: 0;
}

to {
  transform: translateX(0%);
  opacity: 1;
}
`,kJ=ZU.div`
  animation: ${_J} ${t=>t.slideAnimationdurationInSeconds}s ease-in-out;
`,wJ=t=>`Slide_${t}`;function NJ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function MJ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?NJ(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NJ(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const RJ=t=>{const{children:e,headers:i,imageAlt:n,fallbackImageUrl:o,footer:r,hasOuterBorders:a,styles:s,useCircularLogo:l=!0,carouselProps:c,updateFirstFocusableElementRef:d,isRtl:u}=t,h=(0,VR.useCallback)(((t,e)=>({content:VR.createElement(LJ,{key:wJ(e),cardHeader:t,imageAlt:n,useCircularLogo:l,fallbackImageUrl:o,styles:YJ(s?.cardHeader,t?.styles)}),announcedMessage:t.announcedMessage})),[n,l,o,s]);return VR.createElement(BJ,{hasOuterBorders:!!a,maxHeightInPx:600,style:s?.root},VR.createElement(FJ,{style:s?.container,tokens:{childrenGap:4}},i.length>0&&c?VR.createElement(PJ,{slides:i.map(h),isAnimated:!0,carouselControlsIcons:c.carouselControlsIcons,updateNotificationText:c.updateNotificationText,nextButtonAriaLabel:c.nextButtonAriaLabel,previousButtonAriaLabel:c.previousButtonAriaLabel,onSlideChangeClick:c.onSlideChangeClick,updateFirstFocusableElementRef:d,isRtl:u}):VR.createElement(LJ,{key:wJ(0),cardHeader:i[0],imageAlt:n,useCircularLogo:l,fallbackImageUrl:o,styles:YJ(s?.cardHeader,i[0]?.styles)}),e&&VR.createElement(KJ,{style:s?.body},e)),r&&VR.createElement(zJ,{style:s?.footer},r))},LJ=t=>{const{cardHeader:{title:e,imageUrl:i,description:n},fallbackImageUrl:o,useCircularLogo:r,imageAlt:a,styles:s}=t,l=(0,VR.useMemo)((()=>r?HJ:UJ),[r]),c=(0,VR.useMemo)((()=>r?VJ:GJ),[r]);return VR.createElement(jJ,{style:s?.root},VR.createElement(l,{style:s?.logoContainer},VR.createElement(c,{src:i,alt:a,style:s?.logo,onError:({currentTarget:t})=>{t.onerror=null,t.src=o??i,o&&(s?.fallbackLogo?.width&&(t.style.width=`${s.fallbackLogo.width}`),s?.fallbackLogo?.height&&(t.style.height=`${s.fallbackLogo.height}`))}})),e&&VR.createElement($J,{style:s?.title},e),n&&VR.createElement(WJ,{style:s?.description},n))},BJ=ZU.div`
  background-color: var(--inbox-coupon-card-background);
  border: ${t=>t.hasOuterBorders?"1px solid var(--inbox-coupons-card-border-color)":"none"};
  border-radius: 8px;

  position: relative;
  overflow-y: hidden;
  max-height: ${t=>t.maxHeightInPx}px;
  scrollbar-gutter: "auto";

  padding: ${t=>t.padding?`${t.padding}px`:"0"};

  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -ms-overflow-style: scrollbar;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);

  &::-webkit-scrollbar {
    width: 8px;
    height: 12px;
  }

  &::-webkit-scrollbar-thumb {
    border-radius: 8px;
    border: solid 2px var(--inbox-coupon-card-background);
    background: var(--inbox-coupons-scrollbar-color);
    min-height: 40px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }
`,FJ=ZU(NX)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-align: center;
  padding: 10px 20px;
  color: var(--neutral-foreground-rest);
`,UJ=ZU.div`
  line-height: 0;
`,HJ=ZU.div`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100px;
  height: 100px;
  background-color: var(--neutral-fill-rest);
  border-radius: 50%;
  line-height: 0;
`,GJ=ZU.img`
  width: 150px;
`,VJ=ZU.img`
  height: 50%;
`,jJ=ZU.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  margin: 0 auto;
  width: 100%;
`,$J=ZU.h3`
  color: var(--inbox-coupon-card-title-color);
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  line-height: 24px;
`,WJ=ZU.div`
  color: var(--inbox-coupon-card-description-color);
  margin: 8px 0 0 0;
  font-size: 12px;
  line-height: 16px;
  width: 100%;
`,zJ=ZU.div`
  padding: 12px 16px 16px 16px;
  border-top: 1px solid var(--neutral-fill-rest);
  font-size: var(--type-ramp-minus-1-font-size);
  color: var(--neutral-foreground-hint);
`,KJ=ZU.div`
  width: 100%;
	text-align: center;
	flex-grow: 1;
	display: flex;
	align-items: center;
	justify-content: center;
`,YJ=(t,e)=>({description:qJ(t?.description,e?.description),fallbackLogo:qJ(t?.fallbackLogo,e?.fallbackLogo),logo:qJ(t?.logo,e?.logo),logoContainer:qJ(t?.logoContainer,e?.logoContainer),root:qJ(t?.root,e?.root),title:qJ(t?.title,e?.title)}),qJ=(t,e)=>MJ(MJ({},t),e),XJ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M1115 1024l690 691-90 90-691-690-691 690-90-90 690-691-690-691 90-90 691 690 691-690 90 90-690 691z"})),JJ=t=>{const{hidden:e,onDismiss:i,header:n,subText:o,body:r,footer:a,styles:s}=t,l=(0,VR.useRef)(null);return VX(!e,l,(()=>{i?.()})),VR.createElement(ZJ,{styles:s?.root??{}},!e&&VR.createElement(VR.Fragment,null,VR.createElement(QJ,{styles:s?.root??{}}),VR.createElement(tZ,{ref:l,styles:s?.content??{}},VR.createElement(eZ,{styles:s?.header??{}},n),o&&VR.createElement(iZ,{styles:s?.subText??{}},o),VR.createElement(nZ,{styles:s?.body??{}},r),VR.createElement(oZ,{styles:s?.footer??{}},a))))},ZJ=ZU.div`
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9;
    ${({styles:t})=>t}
`,QJ=ZU.div`
    background-color: rgba(0, 0, 0, 0.4);
    position: absolute;
    visibility: visible;
    width: 100%;
    height: 100%;
    ${({styles:t})=>t}
`,tZ=ZU.div`
    visibility: visible;

    box-shadow: rgba(0, 0, 0, 0.12) 0px 3px 6px;
    border-radius: 8px;

    background-color: var(--inbox-coupon-card-background);

    position: relative;

    outline: transparent solid 3px;
    border: 1px solid rgba(0, 0, 0, 0.08);
    box-sizing: border-box;

    max-height: calc(100% - 32px);
    max-width: calc(100% - 32px);
    min-height: 176px;
    min-width: 288px;
    width: 305px;

    overflow-y: auto;

    display: flex;
    flex-direction: column;

    padding: 16px;
    ${({styles:t})=>t}
`,eZ=ZU.div`
    margin-bottom: 8px;

    color: var(--inbox-coupon-card-title-color);

    font-size: 16px;
    line-height: 24px;
    font-weight: 600;
    ${({styles:t})=>t}
`,iZ=ZU.p`
    margin: 0;
    font-size: 14px;
    line-height: 20px;
    font-weight: 400;
    text-align: start;
    color: var(--neutral-foreground-hint);
    ${({styles:t})=>t}
`,nZ=ZU.div`
    margin-bottom: 12px;
    flex: 1;
    ${({styles:t})=>t}
`,oZ=ZU.div`
    ${({styles:t})=>t}
`,rZ=t=>VR.createElement("svg",yX({width:"14",height:"15",viewBox:"0 0 14 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M7 14.5C10.866 14.5 14 11.366 14 7.5C14 3.63401 10.866 0.5 7 0.5C3.13401 0.5 0 3.63401 0 7.5C0 11.366 3.13401 14.5 7 14.5ZM5.95 10.65C5.95 10.0701 6.4201 9.6 7 9.6C7.5799 9.6 8.05 10.0701 8.05 10.65C8.05 11.2299 7.5799 11.7 7 11.7C6.4201 11.7 5.95 11.2299 5.95 10.65ZM6.31128 3.87417C6.37055 3.54763 6.65636 3.3 7 3.3C7.34364 3.3 7.62945 3.54763 7.68872 3.87417L7.7 4V7.5L7.68872 7.62583C7.62945 7.95237 7.34364 8.2 7 8.2C6.65636 8.2 6.37055 7.95237 6.31128 7.62583L6.3 7.5V4L6.31128 3.87417Z"}));function aZ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function sZ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?aZ(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aZ(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const lZ=t=>{const{title:e,description:i,styles:n,onRenderIcon:o}=t,{inboxCouponsAssets:r,isDarkMode:a}=(0,VR.useContext)(Zq);return VR.createElement(NX,{styles:cZ,style:n?.root,tokens:{childrenGap:10},horizontal:!0},VR.createElement(dZ,null,o?o():r.getIcon(rZ,{dark:a,style:sZ({fill:"var(--inbox-coupons-danger-color)",paddingTop:"1px"},n?.icon??{})},lX.JSXElement)),VR.createElement(uZ,{style:n?.textWrapper},VR.createElement(hZ,{style:n?.title},e),VR.createElement(pZ,{style:n?.description},i)))},cZ={root:{backgroundColor:"var(--inbox-coupon-error-message-background-color)",display:"flex",textAlign:"start",padding:"14px 16px",alignItems:"center",borderRadius:"4px"}},dZ=ZU.div`
  display: flex;
  width: 16px;
  height: 16px;
  align-self: start;
  paddingTop: 1px;
`,uZ=ZU.div`
  margin: 0;
  color: var(--neutral-foreground-hint);
  font-size: 12px;
`,hZ=ZU.h4`
  color: var(--inbox-coupons-danger-color);
  font-weight: 600;
  font-size: 12px;
  line-height: 16px;
  margin: 0;
`,pZ=ZU.p`
  color: var(--neutral-foreground-hint);
  font-size: 12px;
  line-height: 16px;
  margin: 0;
  margin-top: 4px;
`,gZ=({size:t,styles:e})=>VR.createElement(mZ,{size:t,style:e?.root}),fZ=JU`
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
`,mZ=ZU.div`
    box-sizing: border-box;
    border-radius: 50%;
    border-width: 1.5px;
    border-style: solid;
    border-color: var(--inbox-coupons-spinner-border-gradient-colors);
    border-image: initial;
    animation-name: ${fZ};
    animation-duration: 1.3s;
    animation-iteration-count: infinite;
    animation-timing-function: cubic-bezier(0.53, 0.21, 0.29, 0.67);
    width: ${t=>t.size??16}px;
    height: ${t=>t.size??16}px;
`,CZ=t=>{const{email:e,isDialogOpen:i,setIsDialogOpen:n}=t,{deleteEmail:o}=(0,VR.useContext)(iX),{handleUserDisconnection:r}=(0,VR.useContext)(mX),{flyoutData:a,inboxCouponsAssets:s,isDarkMode:l}=(0,VR.useContext)(Zq),[c,d]=(0,VR.useState)(!1),[u,h]=(0,VR.useState)(!1),p=(0,VR.useCallback)((()=>{n?.((t=>!t)),h(!1)}),[]),f=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsDisconnectEmail,void 0,void 0,!0,tt.INBOX_COUPONS),d(!0),h(!1);await(o?.(e))?(r?.(),n?.(!1),h(!1)):h(!0),d(!1)}),[o,r,a.strings.disconnectInboxErrorMsg]);(0,VR.useEffect)((()=>{u&&Fq.logClientErrorTelemetry(C.InboxCouponsDisconnectEmailError,new Error("Error in disconnecting the emails!"))}),[u]);const m=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsCancelDisconnectEmail,void 0,void 0,!0,tt.INBOX_COUPONS),p()}),[p]),y=VR.createElement(NX,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},VR.createElement(yZ,null,a.strings.disconnectInboxDialogTitle),VR.createElement(TX,{styles:vZ,onClick:()=>n?.(!1),disabled:c,ariaLabel:a.strings.commonClose,buttonText:s.getIcon(XJ,{dark:l,style:{fill:"var(--neutral-foreground-rest)",width:"14px",height:"14px"}},lX.JSXElement)}));return VR.createElement(JJ,{hidden:!i,onDismiss:()=>c?{}:p(),header:y,subText:a.strings.disconnectInboxDialogDescription,body:VR.createElement(VR.Fragment,null,u&&VR.createElement(lZ,{title:a.strings.disconnectionFailed,description:a.strings.disconnectInboxErrorMsg,styles:{root:{marginTop:"12px"}}})),footer:VR.createElement(NX,{horizontal:!0,tokens:{childrenGap:8}},VR.createElement(TX,{onClick:f,disabled:c,styles:SZ,buttonText:VR.createElement(NX,{horizontal:!0,verticalAlign:"center"},c&&VR.createElement(gZ,{styles:{root:{marginInlineEnd:"10px"}}})," ",a.strings.disconnect),ariaLabel:a.strings.disconnect}),VR.createElement(TX,{onClick:m,disabled:c,styles:SZ,buttonText:a.strings.cancel,ariaLabel:a.strings.cancel}))})},yZ=ZU.h4`
  font-size: 16px;
  font-weight: 600;
  line-height: 24px;
  margin: 0;
  text-align: start;
`,vZ={container:{width:"32px"},button:{minWidth:"none",transitionDuration:"0.1s",padding:0,height:"32px"},text:{lineHeight:0}},SZ={container:{width:"50%",height:"32px",transitionDuration:"0.1s"},button:{padding:"6px 0",border:"1px solid var(--inbox-coupon-button-border-color)",borderRadius:"4px",fontWeight:"400"}},bZ={light:"inboxCoupons/common/Light/Reconnect_150X100_3X.png?02072023",dark:"inboxCoupons/common/Dark/Reconnect_150X100_3X_Dark.png?02072023"};var TZ=(t,e,...i)=>{const n=[],o=t.split(/\$\d/);let r=0;for(const t of o){const e=t.split("*br*").map((t=>t.split("<br>"))).flat();for(let t=0;t<e.length;t++){const i=e[t];n.push(VR.createElement("span",null,i)),t!==e.length-1&&n.push(VR.createElement("br",null))}r<i.length&&n.push(i[r]),r+=1}return VR.createElement("div",{style:e},n)};const AZ=()=>{const{flyoutData:t,inboxCouponsAssets:e,isDarkMode:i}=(0,VR.useContext)(Zq),{getEmailProvider:n,userData:o,microsoftLogin:r,googleLogin:a}=(0,VR.useContext)(iX),[s,l]=(0,VR.useState)(!1),c=(0,VR.useMemo)((()=>o?.emails[0]??""),[o]),d=(0,VR.useMemo)((()=>n?.(c)),[n,c]),u=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsOpenDisconnectModal,{emailProvider:d}),l(!0)}),[l]),h=(0,VR.useCallback)((async t=>(await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsReconnectWith,{emailProvider:d}),d===tX.Microsoft?r?.(!1):d===tX.Gmail?a?.(!1):void 0)),[d,r,a]),p=(0,VR.useCallback)((()=>VR.createElement(VR.Fragment,null,VR.createElement(NX,{horizontalAlign:"center",tokens:{childrenGap:14}},Object.values(tX).includes(d)?VR.createElement(TX,{ariaLabel:Me.ReplaceValueInKey("reconnectWithYourEmailProvider",t.strings.reconnectWithYourEmailProvider,t.strings[`emailProvider${d}`]),onClick:h,imageUrl:e.getIcon(d===tX.Microsoft?KX:d===tX.Gmail?jX:null,{dark:i})||e.getIcon($X,{dark:i}),buttonText:Me.ReplaceValueInKey("reconnectWithYourEmailProvider",t.strings.reconnectWithYourEmailProvider,t.strings[`emailProvider${d}`]),styles:{button:{borderRadius:"8px",backgroundColor:"var(--inbox-coupons-button-background-color)",border:"1px solid var(--inbox-coupons-button-border-color)"}}}):VR.createElement(VR.Fragment,null),VR.createElement("div",{style:{width:"100%"}},VR.createElement(xZ,null,Me.ReplaceValueInKey("previouslyLinkedToEmailAddress",t.strings.previouslyLinkedToEmailAddress,c)),VR.createElement(OZ,{onClick:u},Me.ReplaceValueInKey("performActionOnDifferentEmailAddress",t.strings.performActionOnDifferentEmailAddress,t.strings.connect)))),VR.createElement(CZ,{email:c,isDialogOpen:s,setIsDialogOpen:l}))),[o,d,s,l,r,a]);return VR.createElement(RJ,{headers:[{title:TZ(t.strings.accessRevokedInboxCouponsTitle),imageUrl:e.getIcon(bZ,{dark:i}),description:p()}],imageAlt:Me.ReplaceValueInKey("commonAriaLogo",t.strings.commonAriaLogo,t.strings.accessRevokedInboxCouponsTitle),hasOuterBorders:!0,useCircularLogo:!1,styles:{cardHeader:{title:{marginTop:"5px"}}}})},OZ=ZU.button`
  &:enabled {
    color: var(--inbox-coupon-hyperlink-color);
    cursor: pointer;
  }
  background: transparent;
  border: none;
  padding: 5px 0;
  text-decoration: underline;
  font-size: 12px;
`,xZ=ZU.div`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,EZ={light:"inboxCoupons/common/Light/Different_Email_150X100_3X.png?02072023",dark:"inboxCoupons/common/Dark/Different_Email_150X100_3X_Dark.png?02072023"},PZ=()=>{const{flyoutData:t,inboxCouponsAssets:e,isDarkMode:i}=(0,VR.useContext)(Zq),{getEmailProvider:n,userData:o,microsoftLogin:r,googleLogin:a}=(0,VR.useContext)(iX),[s,l]=(0,VR.useState)(!1),c=(0,VR.useMemo)((()=>o?.emails[0]??""),[o]),d=(0,VR.useMemo)((()=>n?.(c)),[n,c]),u=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsReconnect,{emailProvider:d}),d===tX.Microsoft?r?.(!1):d===tX.Gmail&&a?.(!1)}),[d,r,a]),h=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsOpenDisconnectModal,{emailProvider:d}),l(!0)}),[l]),p=(0,VR.useMemo)((()=>Me.ReplaceValueInKey("orReconnectEmailAction",t.strings.orReconnectEmailAction,t.strings.reconnect,c)),[t.strings.orReconnectEmailAction,t.strings.reconnect,c]),f=(0,VR.useCallback)((()=>VR.createElement(VR.Fragment,null,Object.values(tX).includes(d)?VR.createElement(TX,{ariaLabel:t.strings.disconnectYourCurrentInbox,onClick:h,buttonText:t.strings.disconnectYourCurrentInbox,styles:{button:{borderRadius:"8px",backgroundColor:"var(--inbox-coupons-button-background-color)",border:"1px solid var(--inbox-coupons-button-border-color)"}}}):VR.createElement(VR.Fragment,null),VR.createElement(IZ,{onClick:u,style:{width:"100%"}},VR.createElement(DZ,{title:p},p)),VR.createElement(CZ,{email:c,isDialogOpen:s,setIsDialogOpen:l}))),[o,d,s,l,p]);return VR.createElement(RJ,{headers:[{title:t.strings.reconnectedDifferentEmailTitle,imageUrl:e.getIcon(EZ,{dark:i}),description:f()}],imageAlt:Me.ReplaceValueInKey("commonAriaLogo",t.strings.commonAriaLogo,t.strings.reconnectedDifferentEmailTitle),hasOuterBorders:!0,useCircularLogo:!1})},IZ=ZU.button`
  &:enabled {
    color: var(--inbox-coupon-hyperlink-color);
    cursor: pointer;
  }
  background: transparent;
  border: none;
  margin: 10px 0 0 0;
  padding: 0;
  text-decoration: underline;
  font-size: 12px;
`,DZ=ZU.div`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,_Z=t=>{const{barHeight:e,percentComplete:i,styles:n}=t;return VR.createElement(kZ,{barHeight:e,styles:n?.root??{}},VR.createElement(wZ,{styles:n?.track??{}}),VR.createElement(NZ,{percentComplete:i,styles:n?.progress??{}}))},kZ=ZU.div`
    height: ${t=>t.barHeight}px;
    position: relative;
    width: 100%;
    margin: 8px 0px;
    overflow: hidden;
    ${({styles:t})=>t}
`,wZ=ZU.div`
    width: 100%;
    height: 100%;
    background-color: var(--inbox-coupon-progress-bar-track);
    border-radius: 23px;
    top: 0;
    left: 0;
    ${({styles:t})=>t}
`,NZ=ZU.div`
    background: ${t=>void 0!==t.percentComplete?"var(--inbox-coupon-hyperlink-color)":"linear-gradient(to right, var(--inbox-coupon-progress-bar-track) 0%, var(--inbox-coupon-hyperlink-color) 50%, var(--inbox-coupon-progress-bar-track) 100%)"};
    height: 100%;
    position: absolute;
    transition: width 0.15s linear 0s;
    border-radius: 2px;
    top: 0;
    left: ${t=>void 0!==t.percentComplete?"0":"-33%"};
    width: ${t=>100*(t.percentComplete??.33)}%;
    animation: ${t=>void 0!==t.percentComplete?"none":"3s ease 0s infinite normal none running infiniteLoading"};

    @keyframes infiniteLoading {
        0% { left: -33%; }
        100% { left: 100%; }
    }
    ${({styles:t})=>t}
`,MZ={light:"inboxCoupons/common/Light/Awareness_Signin_150X100_3X.png?02072023",dark:"inboxCoupons/common/Dark/Awareness_Signin_150X100_3X_Dark.png?02072023"},RZ=()=>{const{flyoutData:t,inboxCouponsAssets:e,isDarkMode:i}=(0,VR.useContext)(Zq);return VR.createElement(RJ,{headers:[{title:TZ(t.strings.connectingEmail),imageUrl:e.getIcon(MZ,{dark:i}),announcedMessage:t.strings.connectingEmail}],fallbackImageUrl:e.getIcon(MZ,{dark:i}),imageAlt:t.strings.connectingEmail,hasOuterBorders:!0,useCircularLogo:!1},VR.createElement(_Z,{barHeight:4}))},LZ=t=>VR.createElement("svg",yX({width:"8",height:"11",viewBox:"0 0 8 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M0.7514 1.31352L0.75 2.375V7.6271C0.75 8.52455 1.47754 9.2521 2.375 9.2521L6.68315 9.25225C6.52865 9.6891 6.112 10.0021 5.6222 10.0021H2.375C1.06333 10.0021 0 8.9388 0 7.6271V2.375C0 1.88464 0.313725 1.46756 0.7514 1.31352ZM6.875 0C7.4963 0 8 0.50368 8 1.125V7.625C8 8.2463 7.4963 8.75 6.875 8.75H2.375C1.75368 8.75 1.25 8.2463 1.25 7.625V1.125C1.25 0.50368 1.75368 0 2.375 0H6.875ZM6.875 0.75H2.375C2.1679 0.75 2 0.917895 2 1.125V7.625C2 7.8321 2.1679 8 2.375 8H6.875C7.0821 8 7.25 7.8321 7.25 7.625V1.125C7.25 0.917895 7.0821 0.75 6.875 0.75Z"})),BZ=t=>{const{couponCode:e,isNew:i,handleCopyCode:n,focused:o,onFocus:r,onBlur:a}=t,{flyoutData:s,inboxCouponsAssets:l,isDarkMode:c,updateNotificationText:d}=(0,VR.useContext)(Zq),[u,h]=(0,VR.useState)(!1),[p,g]=(0,VR.useState)(!1),f=(0,VR.useCallback)((()=>{h(!0),r?.()}),[r]),m=(0,VR.useCallback)((()=>{h(!1),g(!1),a?.()}),[a]),C=(0,VR.useCallback)((t=>{n(e,t),d(Me.ReplaceValueInKey("copiedInboxCoupon",s.strings.copiedInboxCoupon,e)),g(!0)}),[e,n]),y=(0,VR.useRef)(null);return(0,VR.useEffect)((()=>{o?y.current?.focus():y.current?.blur()}),[o]),VR.createElement(FZ,{onMouseEnter:f,onFocus:f,onMouseLeave:m,onBlur:m,onClick:C,tabIndex:0,title:`${e} - ${i?s.strings.newInboxCouponFound:s.strings.inboxCouponDescription}`,ref:y},u&&VR.createElement(UZ,{"aria-hidden":!0},p?s.strings.couponCopied.toLocaleUpperCase():s.strings.couponCopyLabelRefresh.toLocaleUpperCase()),VR.createElement(HZ,{"aria-label":p?Me.ReplaceValueInKey("copiedInboxCoupon",s.strings.copiedInboxCoupon,e):Me.ReplaceValueInKey("copyInboxCoupon",s.strings.copyInboxCoupon,e)},e),l.getIcon(LZ,{style:{fill:"var(--inbox-coupon-selected-color)",minWidth:"8px"},dark:c},lX.JSXElement))},FZ=ZU.button`
    position: relative;
    border: 1px dashed var(--inbox-coupon-selected-border-color);
    padding: 3px 5px;
    font-size: 12px;
    font-weight: 700;
    margin: 0;
    border-radius: 3px;
    background: transparent;
    font-family: inherit;
    min-width: 50px;
    max-width: 200px;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    display: flex;
    align-items: center;
    gap: 5px;
    justify-content: space-between;
`,UZ=ZU.div`
    position: absolute;
    cursor: pointer;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    --overlay-opacity: 0.9;
    background: linear-gradient(to bottom, var(--neutral-fill-rest) calc((var(--overlay-opacity) - 1) * 10000%), transparent calc(var(--overlay-opacity) * 10000%));
    color: var(--neutral-foreground-rest);
`,HZ=ZU.span`
    color: var(--inbox-coupon-selected-color);
    font-size: 12px;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
`,GZ=t=>{const{coupon:e,handleCopyCode:i,focused:n,onBlur:o,onFocus:r}=t,{flyoutData:a}=(0,VR.useContext)(Zq);return VR.createElement(VZ,null,VR.createElement(NX,{horizontal:!0,tokens:{childrenGap:16},verticalAlign:"center"},VR.createElement(BZ,{couponCode:e.couponCode,isNew:e.new,handleCopyCode:i,focused:n,onFocus:r,onBlur:o}),e.new&&VR.createElement(uJ,{text:a.strings.newCoupon,ariaLabel:a.strings.newInboxCouponFound})),VR.createElement(jZ,null,Me.ReplaceValueInKey("retailerSentYouThisCoupon",a.strings.retailerSentYouThisCoupon,e.senderDomain)))},VZ=ZU(NX)``,jZ=ZU.p`
    color: var(--neutral-foreground-hint);
    margin: 0;
    padding-top: 6px;
    font-size: 12px;
    line-height: 16px;
    font-weight: 400;
`,$Z=t=>VR.createElement("svg",yX({width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("rect",{width:"40",height:"40",rx:"4",fill:"#F5F5F5"}),VR.createElement("path",{d:"M24 17.5C24 18.3284 23.3284 19 22.5 19C21.6716 19 21 18.3284 21 17.5C21 16.6716 21.6716 16 22.5 16C23.3284 16 24 16.6716 24 17.5ZM23 17.5C23 17.2239 22.7761 17 22.5 17C22.2239 17 22 17.2239 22 17.5C22 17.7761 22.2239 18 22.5 18C22.7761 18 23 17.7761 23 17.5ZM13 16C13 14.3431 14.3431 13 16 13H24C25.6569 13 27 14.3431 27 16V24C27 25.6569 25.6569 27 24 27H16C14.3431 27 13 25.6569 13 24V16ZM16 14C14.8954 14 14 14.8954 14 16V24C14 24.3726 14.1019 24.7215 14.2794 25.0201L18.9487 20.432C19.5323 19.8586 20.4677 19.8586 21.0513 20.432L25.7206 25.0201C25.8981 24.7215 26 24.3726 26 24V16C26 14.8954 25.1046 14 24 14H16ZM16 26H24C24.3692 26 24.7149 25.9 25.0118 25.7256L20.3504 21.1453C20.1559 20.9542 19.8441 20.9542 19.6496 21.1453L14.9882 25.7256C15.2851 25.9 15.6308 26 16 26Z",fill:"#1A1A1A"}));function WZ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function zZ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?WZ(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WZ(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const KZ=t=>{const{ariaLabel:e,retailer:i,subtitle:n,activeRetailerId:o,styles:r}=t,{flyoutData:a,inboxCouponsAssets:s,isDarkMode:l}=(0,VR.useContext)(Zq);return VR.createElement(ZX,{ariaLabel:e,titleTooltip:e,collapsable:!0,expanded:o===i.id,fallbackImageUrl:s.getIcon($Z,{dark:l}),imageAlt:Me.ReplaceValueInKey("commonAriaLogo",a.strings.commonAriaLogo,i.name),imageUrl:s.getRetailerLogoUrl(i.id),subtitle:n,title:i.name,styles:zZ(zZ({},r?.headerStyles??{}),YZ)})},YZ={logoContainer:{marginInlineEnd:"20px"}},qZ=t=>{const{onRenderSummary:e,onRenderContent:i,expanded:n,animationDuration:o,animationEasing:r,isAlwaysExpanded:a,onClick:s,onExpansionEnd:l,summaryAriaLabel:c,styles:d}=t,u=o??200,h=r??"ease-in-out",[p,g]=(0,VR.useState)(!1),[f,m]=(0,VR.useState)(!1),C=(0,VR.useRef)({}),y=(0,VR.useRef)({}),v=(0,VR.useRef)({}),[S,b]=(0,VR.useState)(null),T=(0,VR.useCallback)((t=>{C.current&&(C.current.open=t,b(null),m(!1),g(!1),C.current.style.height=C.current.style.overflow="")}),[C]),A=(0,VR.useCallback)((()=>{C.current&&(C.current.style.height=`${C.current.offsetHeight}px`,C.current.open=!0,requestAnimationFrame((()=>{g(!0);const t=`${y.current.offsetHeight}px`,e=`${ZZ(y.current)+ZZ(v.current)}px`;S&&S.cancel();let i=new Animation;i=C.current.animate({height:[t,e]},{duration:u,easing:h}),i.onfinish=()=>{T(!0),l?.(C.current)},i.oncancel=()=>g(!1),b(i)})))}),[C,y,v,S,u,h]),O=(0,VR.useCallback)((()=>{if(!C.current)return;m(!0);const t=`${ZZ(C.current)}px`,e=`${ZZ(y.current)}px`;S&&S.cancel();let i=new Animation;i=C.current.animate({height:[t,e]},{duration:u,easing:h}),i.onfinish=()=>T(!1),i.oncancel=()=>m(!1)}),[C,y,v,S,u,h,T]),x=(0,VR.useCallback)((t=>{a||(f||!C.current.open?A():(p||C.current.open)&&O(),s?.(t))}),[A,O,s,f,p,C]);(0,VR.useEffect)((()=>{n&&A()}),[]);const E=(0,VR.useMemo)((()=>a||n||p||f),[a,n,p,f]);return VR.createElement(XZ,{open:E,ref:C,onClick:t=>t.preventDefault(),"aria-expanded":n,style:d?.details},VR.createElement(JZ,{ref:y,onClick:x,role:"button","aria-label":c,style:d?.summary},e()),VR.createElement("div",{ref:v,onClick:t=>t.preventDefault(),style:{border:"1px solid transparent"}},i()))},XZ=ZU.details`
  &:not(:last-child) {
    border-bottom: 1px solid var(--neutral-fill-rest);
  }

  overflow: hidden;
  transition: all ease-in-out 200ms;

  padding: 0px 16px;
`,JZ=ZU.summary`
  cursor: pointer;
  &::-webkit-details-marker {
    display:none;
  }
  list-style: none;

  &:focus-visible {
    outline: calc(var(--stroke-width) * 1px) auto var(--focus-stroke-outer);
    box-shadow: 0 0 0 calc((var(--focus-stroke-width) - var(--stroke-width)) * 1px) var(--focus-stroke-outer);
  }
`,ZZ=t=>{const e=getComputedStyle(t);return t.scrollHeight-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)};function QZ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function tQ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?QZ(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QZ(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const eQ=t=>{const{groups:e,handleRenderRetailerHeader:i,handleRenderItem:n,handleRenderItemContentSeeMore:o,handleFilterRetailerItem:r,expandedGroupKey:a,showAll:s,useItemFilter:l,maxHeightInPx:c,isAlwaysExpanded:d,onSeeMoreClick:u,onSummaryClick:h,header:p,footer:f,wrapInNonStyledCard:m,styles:C}=t,[y,v]=(0,VR.useState)(!!s),[S,b]=(0,VR.useState)(!l),{setFocusedCouponKey:T}=(0,VR.useContext)(mX),{flyoutData:A,isDarkMode:O,inboxCouponsAssets:x}=(0,VR.useContext)(Zq),E=(0,VR.useRef)(null),P=(0,VR.useCallback)((async t=>{await(u?.(t)),v(!0),E.current?.focus()}),[v,u,E.current]),I=(0,VR.useCallback)((t=>{E.current?.scrollTo({top:t.offsetTop-parseFloat(window.getComputedStyle(E.current)?.["padding-top"]??"0"),behavior:"smooth"})}),[E.current]),D=(0,VR.useMemo)((()=>y?[...e]:[...e.slice(0,3)]),[y,e]),_=(0,VR.useCallback)((t=>{let e=t.items,s=VR.createElement(VR.Fragment,null);if(!S){e=e.filter((t=>r?.(t)??!0)),0===e.length&&(e=t.items);const i=Math.min(e.length,5);if(i<t.items.length){const n=e.length>5;s=VR.createElement(oQ,null,o?.(t.items.length-i,t.items.length,(async e=>{await Fq.logButtonClickTelemetry(e.target,n?g.InboxCouponsSeeMoreCoupons:g.InboxCouponsSeeOlderCoupons,{retailerName:t.name,retailerId:t.id}),b(!0),T((t=>{const e=t.split("-");return e.length>0?(e[e.length-1]=`${parseInt(e[e.length-1],10)+1}`,e.join("-")):""}))}),n))}e=e.slice(0,5)}return VR.createElement(qZ,{summaryAriaLabel:t.ariaLabel,expanded:t.key===a,onRenderSummary:()=>i(t),onRenderContent:()=>VR.createElement(VR.Fragment,null,e.length>0&&VR.createElement(NX,{tokens:{padding:"0 0 10px 0"},styles:C?.itemsListWrapper},VR.createElement(iQ,{style:C?.itemsList},e.map(((e,i)=>VR.createElement(nQ,{style:C?.item},n(e,i,t)))),s))),isAlwaysExpanded:d,onClick:e=>{h?.(t,e),b(!l)},onExpansionEnd:I,styles:C?.accordionItem})}),[S,r,o,b,i,n,h,I]);return VR.createElement(VR.Fragment,null,VR.createElement(BJ,{hasOuterBorders:!m,maxHeightInPx:c??315,ref:E,style:tQ(tQ({},C?.root??{}),{"overflow-y":"overlay"})},p,D.map((t=>_(t))),f),!y&&e.length>3&&VR.createElement(cJ,{inboxCouponsAssets:x,onClick:P,text:Me.ReplaceValueInKey("sectionSeeMore",A.strings.sectionSeeMore,""+(e.length-3)),title:Me.ReplaceValueInKey("retailersTitleWithNum",A.strings.retailersTitleWithNum,`${e.length}`),isDarkMode:O}))},iQ=ZU.ul`
  display: initial;
  padding: 0 10px;
  margin: 0;

  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -ms-overflow-style: scrollbar;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  border: 1px solid var(--inbox-coupons-card-border-color);
  border-radius: 6px;

  &::-webkit-scrollbar {
    width: 8px;
    height: 12px;
  }

  &::-webkit-scrollbar-thumb {
    border-radius: 8px;
    border: solid 2px var(--inbox-coupon-card-background);
    background: var(--inbox-coupons-scrollbar-color);
    min-height: 40px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  & > li:not(:first-child) {
    border-top: 1px solid #00000008;
  }
`,nQ=ZU.li`
  padding: 0;
  margin: 0;
  list-style: none;
  &:not(:first-child) {
    border-top: 1px solid var(--neutral-fill-rest);
  }
`,oQ=ZU.li`
  border-top: 1px solid var(--neutral-fill-rest);
  margin: 0;
  list-style: none;
`;function rQ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function aQ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rQ(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rQ(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const sQ=()=>{const{retailersCoupons:t,activeRetailer:e,updateActiveRetailer:i,showAllRetailers:n,updateShowAllRetailers:o,focusedCouponKey:r,setFocusedCouponKey:a}=(0,VR.useContext)(mX),{flyoutData:s,pageHandlerModule:l,inboxCouponsAssets:c}=(0,VR.useContext)(Zq),d=(0,VR.useMemo)((()=>t.map((t=>({ariaLabel:1!==t.items.length?Me.ReplaceValueInKey("inboxRetailerHasCoupons",Me.GetICUPluralString(s.strings.inboxRetailerHasCoupons,M.Other,t.items.length),t.name):Me.ReplaceValueInKey("inboxRetailerHasCoupons",Me.GetICUPluralString(s.strings.inboxRetailerHasCoupons,M.One),t.name),expandAriaLabel:Me.ReplaceValueInKey("showRetailerCoupons",s.strings.showRetailerCoupons,`${t.name}`),items:t.items.map((e=>aQ(aQ({},e),{},{key:`${t.name}|${e.couponCode}`,name:e.couponCode}))),key:t.key,name:t.name,id:t.id})))),[t,Me.ReplaceValueInKey,Me.GetICUPluralString,s.strings.showRetailerCoupons]),u=(0,VR.useMemo)((()=>320*(n?1.5:1)),[n]),h=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsSeeMoreRetailers),o(!0)}),[o]),p=(0,VR.useCallback)((t=>{const i=t.items.some((t=>t.new)),n=VR.createElement(NX,{horizontal:!0,tokens:{childrenGap:13},verticalAlign:"end"},VR.createElement("div",null,Vq.getRetailerSubtitleText(t.items,s)),i&&t.name!==e?.name&&VR.createElement(uJ,{text:s.strings.newCoupon,ariaLabel:s.strings.newInboxCouponFound})),o=Vq.getRetailerAriaLabelText(t.name,t.items,s);return VR.createElement(KZ,{ariaLabel:o,retailer:{ariaLabel:t.ariaLabel,items:t.items,key:t.key,id:t.id,name:t.name},subtitle:n,activeRetailerId:e?.id||"",styles:{headerStyles:{root:{padding:"12px 0"},subtitle:{fontSize:"14px",lineHeight:"20px",fontWeight:"600"}}}})}),[e,i,Me.ReplaceValueInKey,s.strings.couponsCount,s.strings.inboxRetailerHasCoupons]),f=(0,VR.useCallback)((async(t,i)=>{await Fq.logButtonClickTelemetry(i.target,g.InboxCouponsCouponClip,{couponCode:t,retailerName:e?.name,retailerId:e?.id}),l.CopyCoupon(t)}),[l.CopyCoupon,e?.name,e?.id]),m=(0,VR.useCallback)(((t,e,i)=>{const n=`${i.key}-${e}`;return VR.createElement(GZ,{coupon:t,handleCopyCode:f,key:n,focused:n===r,onFocus:()=>a(n)})}),[s.strings.couponCopyLabelRefresh,s.strings.couponCopied,f,r]),C=(0,VR.useCallback)(((t,e)=>{i({id:t.id,name:t.name},(async i=>{await Fq.logButtonClickTelemetry(e.target,g.InboxCouponsToggleExpansionRetailerCoupons,{retailerName:t.name,retailerId:t.id,action:i?"expand":"collapse"})}))}),[i]),y=(0,VR.useCallback)(((t,e,i,n)=>VR.createElement(dJ,{inboxCouponsAssets:c,onClick:i,text:Me.ReplaceValueInKey(n?"sectionSeeMoreCoupons":"sectionSeeOlderCoupons",n?s.strings.sectionSeeMoreCoupons:s.strings.sectionSeeOlderCoupons,`${t}`),title:1!==e?Me.GetICUPluralString(s.strings.couponsCount,M.Other,e):Me.GetICUPluralString(s.strings.couponsCount,M.One),isDarkMode:s.common.currentTheme===$.Dark})),[]),v=(0,VR.useCallback)((t=>Vq.isRecentCoupon(t)),[]);return VR.createElement(eQ,{groups:d,onSeeMoreClick:h,showAll:n,expandedGroupKey:e?.id||"",handleRenderRetailerHeader:p,handleRenderItem:m,useItemFilter:!0,handleRenderItemContentSeeMore:y,handleFilterRetailerItem:v,onSummaryClick:C,maxHeightInPx:u,styles:{itemsList:{maxHeight:"200px",overflow:"auto"},item:{padding:"12px 0"}}})},lQ={light:"inboxCoupons/common/Light/Awareness_Automatic_150X100_3X.png?02072023",dark:"inboxCoupons/common/Dark/Awareness_Automatic_150X100_3X_Dark.png?02072023"},cQ={light:"inboxCoupons/common/Light/Awareness_Privacy_150X100_3X.png?02072023",dark:"inboxCoupons/common/Dark/Awareness_Privacy_150X100_3X_Dark.png?02072023"},dQ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M1443 2045L421 1024 1443 3l90 90-930 931 930 931-90 90z"})),uQ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"red",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M515 1955l930-931L515 93l90-90 1022 1021L605 2045l-90-90z"})),hQ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M32 1024q0-137 35-264t100-237 155-200 201-155T760 68t264-36q137 0 264 35t237 100 200 155 155 201 100 237 36 264q0 137-35 264t-100 237-155 200-201 155-237 100-264 36q-137 0-264-35t-237-100-200-155-155-201-100-237-36-264z"})),pQ=t=>VR.createElement("svg",yX({viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),VR.createElement("path",{d:"M1024 0q141 0 272 36t244 104 207 160 161 207 103 245 37 272q0 141-36 272t-104 244-160 207-207 161-245 103-272 37q-141 0-272-36t-244-104-207-160-161-207-103-245-37-272q0-141 36-272t104-244 160-207 207-161T752 37t272-37zm0 1920q124 0 238-32t214-90 181-140 140-181 91-214 32-239q0-124-32-238t-90-214-140-181-181-140-214-91-239-32q-124 0-238 32t-214 90-181 140-140 181-91 214-32 239q0 124 32 238t90 214 140 181 181 140 214 91 239 32z"})),gQ={light:"inboxCoupons/common/Microsoft_Logo_20X20_3X.png?02072023",dark:"inboxCoupons/common/Microsoft_Logo_20X20_3X.png?02072023"},fQ=t=>{const{headers:e,cardStyles:i,carouselControlsIcons:n}=t,{flyoutData:o,inboxCouponsAssets:r,isDarkMode:a,updateNotificationText:s}=(0,VR.useContext)(Zq),{edgeSignIn:l}=(0,VR.useContext)(iX),c=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsMicrosoftPrivacyStatement)}),[]),d=(0,VR.useMemo)((()=>VR.createElement(aJ,{href:"https://privacy.microsoft.com/privacystatement",target:"_blank",onClick:c},o.strings.commonMicrosoftPolicy)),[o.strings.commonMicrosoftPolicy,c]),u=TZ(o.strings.inboxCouponsEdgeLoginFooterMessage,{},d),h=(0,VR.useCallback)((async t=>{const e=await(l?.());await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsSignInToMicrosoftEdge,{edgeSignInVersion:e})}),[l]),p=(0,VR.useMemo)((()=>n?{carouselControlsIcons:n,updateNotificationText:s,nextButtonAriaLabel:o.strings.next,previousButtonAriaLabel:o.strings.previous,onSlideChangeClick:async(t,e,i)=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsFreCarousel,{action:OJ[e],fromSlide:i,loginCardType:"EdgeLoginCard"})}}:void 0),[s,o.strings.next,o.strings.previous]),f=o.dataLoader.GetLoadTimeDataValue("is_rtl",!1);return VR.createElement(RJ,{headers:e,styles:i,imageAlt:Me.ReplaceValueInKey("commonAriaLogo",o.strings.commonAriaLogo,o.strings.inboxCouponsTitle),fallbackImageUrl:r.getIcon(MZ,{dark:a}),footer:u,hasOuterBorders:!0,useCircularLogo:!1,carouselProps:p,isRtl:f},VR.createElement(NX,{horizontalAlign:"center",tokens:{childrenGap:0},styles:CQ},VR.createElement(TX,{ariaLabel:o.strings.addEdgeProfile,onClick:h,imageUrl:r.getIcon(gQ,{dark:a}),buttonText:o.strings.addEdgeProfile,styles:mQ}),VR.createElement(yQ,null,o.strings.inboxCouponsForEdgeUsersOnly)))},mQ={container:{marginBottom:"0"},button:{boxSizing:"border-box",borderRadius:"8px",backgroundColor:"var(--inbox-coupons-button-background-color)",border:"1px solid var(--inbox-coupons-button-border-color)"},logo:{width:"20px",height:"20px"}},CQ={root:{width:"100%"}},yQ=ZU.p`
  margin: 0;
  padding-top: 12px;
  font-size: var(--type-ramp-minus-1-font-size);
  color: var(--neutral-foreground-hint);
`,vQ=t=>{const{headers:e,cardStyles:i}=t,{flyoutData:n,inboxCouponsAssets:o,isDarkMode:r,pageHandlerModule:a}=(0,VR.useContext)(Zq),s=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsMicrosoftPrivacyStatement)}),[]),l=(0,VR.useMemo)((()=>VR.createElement(aJ,{href:"https://privacy.microsoft.com/privacystatement",target:"_blank",onClick:s},n.strings.commonMicrosoftPolicy)),[n.strings.commonMicrosoftPolicy,s]),c=TZ(n.strings.inboxCouponsEdgeLoginFooterMessage,{},l),d=(0,VR.useCallback)((async t=>{await Fq.logButtonClickTelemetry(t.target,g.InboxCouponsEdgeSwitchProfile),a.NavigateToEdgeUrl("edge://settings/profiles#AddProfile",cn.NEW_FOREGROUND_TAB)}),[]);return VR.createElement(RJ,{headers:e,styles:i,imageAlt:Me.ReplaceValueInKey("commonAriaLogo",n.strings.commonAriaLogo,n.strings.inboxCouponsTitle),fallbackImageUrl:o.getIcon(MZ,{dark:r}),footer:c,hasOuterBorders:!0,useCircularLogo:!1},VR.createElement(NX,{horizontalAlign:"center",tokens:{childrenGap:0},styles:bQ},VR.createElement(TX,{ariaLabel:n.strings.switchingToEdgePersonalProfile,onClick:d,imageUrl:o.getIcon(gQ,{dark:r}),buttonText:n.strings.switchingToEdgePersonalProfile,styles:SQ})))},SQ={container:{marginBottom:"0",marginTop:"5px"},button:{boxSizing:"border-box",borderRadius:"8px",backgroundColor:"var(--inbox-coupons-button-background-color)",border:"1px solid var(--inbox-coupons-button-border-color)"},logo:{wid